{"ast":null,"code":"import _regeneratorRuntime from\"/Users/randyadams/IMMORTIFYV2/immortify-app-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/randyadams/IMMORTIFYV2/immortify-app-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/randyadams/IMMORTIFYV2/immortify-app-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{useHistory}from\"react-router-dom\";import{API}from\"aws-amplify\";import{onError}from\"../libs/errorLib\";import config from\"../config\";import{Elements,StripeProvider}from\"react-stripe-elements\";import BillingForm from\"../components/BillingForm\";import\"./Settings.css\";export default function Settings(){var history=useHistory();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),stripe=_useState4[0],setStripe=_useState4[1];useEffect(function(){setStripe(window.Stripe(config.STRIPE_KEY));},[]);function billUser(details){return API.post(\"notes\",\"/billing\",{body:details});}function handleFormSubmit(_x,_x2){return _handleFormSubmit.apply(this,arguments);}function _handleFormSubmit(){_handleFormSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(storage,_ref){var token,error;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:token=_ref.token,error=_ref.error;if(!error){_context.next=4;break;}onError(error);return _context.abrupt(\"return\");case 4:setIsLoading(true);_context.prev=5;_context.next=8;return billUser({storage:storage,source:token.id});case 8:alert(\"Your card has been charged successfully!\");history.push(\"/\");_context.next=16;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](5);onError(_context.t0);setIsLoading(false);case 16:case\"end\":return _context.stop();}}},_callee,null,[[5,12]]);}));return _handleFormSubmit.apply(this,arguments);}return/*#__PURE__*/React.createElement(\"div\",{className:\"Settings\"},/*#__PURE__*/React.createElement(StripeProvider,{stripe:stripe},/*#__PURE__*/React.createElement(Elements,null,/*#__PURE__*/React.createElement(BillingForm,{isLoading:isLoading,onSubmit:handleFormSubmit}))));}","map":{"version":3,"sources":["/Users/randyadams/IMMORTIFYV2/immortify-app-client/src/containers/Settings.js"],"names":["React","useState","useEffect","useHistory","API","onError","config","Elements","StripeProvider","BillingForm","Settings","history","isLoading","setIsLoading","stripe","setStripe","window","Stripe","STRIPE_KEY","billUser","details","post","body","handleFormSubmit","storage","token","error","source","id","alert","push"],"mappings":"wfAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,OAASC,UAAT,KAA2B,kBAA3B,CACA,OAASC,GAAT,KAAoB,aAApB,CACA,OAASC,OAAT,KAAwB,kBAAxB,CACA,MAAOC,CAAAA,MAAP,KAAmB,WAAnB,CACA,OAASC,QAAT,CAAmBC,cAAnB,KAAyC,uBAAzC,CACA,MAAOC,CAAAA,WAAP,KAAwB,2BAAxB,CACA,MAAO,gBAAP,CAEA,cAAe,SAASC,CAAAA,QAAT,EAAoB,CACjC,GAAMC,CAAAA,OAAO,CAAGR,UAAU,EAA1B,CADiC,cAECF,QAAQ,CAAC,KAAD,CAFT,wCAE1BW,SAF0B,eAEfC,YAFe,8BAGPZ,QAAQ,CAAC,IAAD,CAHD,yCAG5Ba,MAH4B,eAGpBC,SAHoB,eAKnCb,SAAS,CAAC,UAAM,CACda,SAAS,CAACC,MAAM,CAACC,MAAP,CAAcX,MAAM,CAACY,UAArB,CAAD,CAAT,CACD,CAFQ,CAEN,EAFM,CAAT,CAIE,QAASC,CAAAA,QAAT,CAAkBC,OAAlB,CAA2B,CACzB,MAAOhB,CAAAA,GAAG,CAACiB,IAAJ,CAAS,OAAT,CAAkB,UAAlB,CAA8B,CACnCC,IAAI,CAAEF,OAD6B,CAA9B,CAAP,CAGD,CAbgC,QAepBG,CAAAA,gBAfoB,gKAenC,iBAAgCC,OAAhC,uIAA2CC,KAA3C,MAA2CA,KAA3C,CAAkDC,KAAlD,MAAkDA,KAAlD,KACMA,KADN,yBAEIrB,OAAO,CAACqB,KAAD,CAAP,CAFJ,wCAMEb,YAAY,CAAC,IAAD,CAAZ,CANF,sCASUM,CAAAA,QAAQ,CAAC,CACbK,OAAO,CAAPA,OADa,CAEbG,MAAM,CAAEF,KAAK,CAACG,EAFD,CAAD,CATlB,QAcIC,KAAK,CAAC,0CAAD,CAAL,CACAlB,OAAO,CAACmB,IAAR,CAAa,GAAb,EAfJ,iFAiBIzB,OAAO,aAAP,CACAQ,YAAY,CAAC,KAAD,CAAZ,CAlBJ,qEAfmC,mDAqCnC,mBACE,2BAAK,SAAS,CAAC,UAAf,eACE,oBAAC,cAAD,EAAgB,MAAM,CAAEC,MAAxB,eACE,oBAAC,QAAD,mBACE,oBAAC,WAAD,EAAa,SAAS,CAAEF,SAAxB,CAAmC,QAAQ,CAAEW,gBAA7C,EADF,CADF,CADF,CADF,CASC","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { API } from \"aws-amplify\";\nimport { onError } from \"../libs/errorLib\";\nimport config from \"../config\";\nimport { Elements, StripeProvider } from \"react-stripe-elements\";\nimport BillingForm from \"../components/BillingForm\";\nimport \"./Settings.css\";\n\nexport default function Settings() {\n  const history = useHistory();\n  const [isLoading, setIsLoading] = useState(false);\nconst [stripe, setStripe] = useState(null);\n\nuseEffect(() => {\n  setStripe(window.Stripe(config.STRIPE_KEY));\n}, []);\n\n  function billUser(details) {\n    return API.post(\"notes\", \"/billing\", {\n      body: details\n    });\n  }\n\nasync function handleFormSubmit(storage, { token, error }) {\n  if (error) {\n    onError(error);\n    return;\n  }\n\n  setIsLoading(true);\n\n  try {\n    await billUser({\n      storage,\n      source: token.id\n    });\n\n    alert(\"Your card has been charged successfully!\");\n    history.push(\"/\");\n  } catch (e) {\n    onError(e);\n    setIsLoading(false);\n  }\n}\n\nreturn (\n  <div className=\"Settings\">\n    <StripeProvider stripe={stripe}>\n      <Elements>\n        <BillingForm isLoading={isLoading} onSubmit={handleFormSubmit} />\n      </Elements>\n    </StripeProvider>\n  </div>\n);\n}\n"]},"metadata":{},"sourceType":"module"}