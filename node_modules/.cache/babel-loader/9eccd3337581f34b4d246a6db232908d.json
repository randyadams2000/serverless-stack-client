{"ast":null,"code":"\"use strict\";\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _styledComponents = _interopRequireWildcard(require(\"styled-components\"));\n\nvar _tsEbml = require(\"ts-ebml\");\n\nvar _unsupportedView = _interopRequireDefault(require(\"./defaults/unsupported-view\"));\n\nvar _errorView = _interopRequireDefault(require(\"./defaults/error-view\"));\n\nvar _disconnectedView = _interopRequireDefault(require(\"./defaults/disconnected-view\"));\n\nvar _loadingView = _interopRequireDefault(require(\"./defaults/loading-view\"));\n\nvar _renderActions = _interopRequireDefault(require(\"./defaults/render-actions\"));\n\nvar _getVideoInfo = _interopRequireWildcard(require(\"./get-video-info\"));\n\nvar _customErrors = require(\"./custom-errors\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _getRequireWildcardCache() {\n  if (typeof WeakMap !== \"function\") return null;\n  var cache = new WeakMap();\n\n  _getRequireWildcardCache = function _getRequireWildcardCache() {\n    return cache;\n  };\n\n  return cache;\n}\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") {\n    return {\n      default: obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache();\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj.default = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nvar MIME_TYPES = ['video/webm;codecs=\"vp8,opus\"', 'video/webm;codecs=h264', 'video/webm;codecs=vp9', 'video/webm'];\nvar CONSTRAINTS = {\n  audio: true,\n  video: true\n};\n\nvar Wrapper = _styledComponents.default.div.withConfig({\n  displayName: \"video-recorder__Wrapper\",\n  componentId: \"sc-7k20rv-0\"\n})([\"position:relative;display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;height:100%;overflow:hidden;min-height:300px;background-color:#000;color:white;box-sizing:border-box;*{box-sizing:inherit;}\"]);\n\nvar CameraView = _styledComponents.default.div.withConfig({\n  displayName: \"video-recorder__CameraView\",\n  componentId: \"sc-7k20rv-1\"\n})([\"width:100%;height:100%;\"]);\n\nvar Video = _styledComponents.default.video.withConfig({\n  displayName: \"video-recorder__Video\",\n  componentId: \"sc-7k20rv-2\"\n})([\"position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);min-height:100%;min-width:100%;width:100%;height:100%;object-fit:cover;\", \";\", \";\"], function (props) {\n  return props.isFlipped && (0, _styledComponents.css)([\"transform:translate(-50%,-50%) scaleX(-1);\"]);\n}, function (props) {\n  return props.onClick && (0, _styledComponents.css)([\"cursor:pointer;\"]);\n});\n\nvar VideoRecorder = /*#__PURE__*/function (_Component) {\n  _inherits(VideoRecorder, _Component);\n\n  var _super = _createSuper(VideoRecorder);\n\n  function VideoRecorder() {\n    var _this;\n\n    _classCallCheck(this, VideoRecorder);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _defineProperty(_assertThisInitialized(_this), \"videoInput\", /*#__PURE__*/_react.default.createRef());\n\n    _defineProperty(_assertThisInitialized(_this), \"timeSinceInactivity\", 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      isRecording: false,\n      isCameraOn: false,\n      isConnecting: false,\n      isReplayingVideo: false,\n      isReplayVideoMuted: true,\n      thereWasAnError: false,\n      error: null,\n      streamIsReady: false,\n      isInlineRecordingSupported: null,\n      isVideoInputSupported: null,\n      stream: undefined\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"turnOnCamera\", function () {\n      if (_this.props.onTurnOnCamera) {\n        _this.props.onTurnOnCamera();\n      }\n\n      _this.setState({\n        isConnecting: true,\n        isReplayingVideo: false,\n        thereWasAnError: false,\n        error: null\n      });\n\n      var fallbackContraints = {\n        audio: true,\n        video: true\n      };\n      navigator.mediaDevices.getUserMedia(_this.props.constraints).catch(function (err) {\n        // there's a bug in chrome in some windows computers where using `ideal` in the constraints throws a NotReadableError\n        if (err.name === 'NotReadableError' || err.name === 'OverconstrainedError') {\n          console.warn(\"Got \".concat(err.name, \", trying getUserMedia again with fallback constraints\"));\n          return navigator.mediaDevices.getUserMedia(fallbackContraints);\n        }\n\n        throw err;\n      }).then(_this.handleSuccess).catch(_this.handleError);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"turnOffCamera\", function () {\n      if (_this.props.onTurnOffCamera) {\n        _this.props.onTurnOffCamera();\n      }\n\n      _this.stream && _this.stream.getTracks().forEach(function (stream) {\n        return stream.stop();\n      });\n\n      _this.setState({\n        isCameraOn: false\n      });\n\n      clearInterval(_this.inactivityTimer);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleSuccess\", function (stream) {\n      _this.stream = stream;\n\n      _this.setState({\n        isCameraOn: true,\n        stream: stream\n      });\n\n      if (_this.props.onCameraOn) {\n        _this.props.onCameraOn();\n      }\n\n      if (window.URL) {\n        _this.cameraVideo.srcObject = stream;\n      } else {\n        _this.cameraVideo.src = stream;\n      } // there is probably a better way\n      // but this makes sure the start recording button\n      // gives the stream a couple miliseconds to be ready\n\n\n      setTimeout(function () {\n        _this.setState({\n          isConnecting: false,\n          streamIsReady: true\n        });\n      }, 200);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleError\", function (err) {\n      var onError = _this.props.onError;\n      console.error('Captured error', err);\n      clearTimeout(_this.timeLimitTimeout);\n\n      if (onError) {\n        onError(err);\n      }\n\n      _this.setState({\n        isConnecting: _this.state.isConnecting && false,\n        isRecording: false,\n        thereWasAnError: true,\n        error: err\n      });\n\n      if (_this.state.isCameraOn) {\n        _this.turnOffCamera();\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleDataIssue\", function (event) {\n      var error = new _customErrors.ReactVideoRecorderDataIssueError(event);\n      console.error(error.message, event);\n\n      _this.handleError(error);\n\n      return false;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getMimeType\", function () {\n      if (_this.props.mimeType) {\n        return _this.props.mimeType;\n      }\n\n      var mimeType = window.MediaRecorder.isTypeSupported ? MIME_TYPES.find(window.MediaRecorder.isTypeSupported) : 'video/webm';\n      return mimeType || '';\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"isDataHealthOK\", function (event) {\n      if (!event.data) return _this.handleDataIssue(event);\n      var chunkSize = _this.props.chunkSize;\n      var dataCheckInterval = 2000 / chunkSize; // in some browsers (FF/S), data only shows up\n      // after a certain amount of time ~everyt 2 seconds\n\n      var blobCount = _this.recordedBlobs.length;\n\n      if (blobCount > dataCheckInterval && blobCount % dataCheckInterval === 0) {\n        var blob = new window.Blob(_this.recordedBlobs, {\n          type: _this.getMimeType()\n        });\n        if (blob.size <= 0) return _this.handleDataIssue(event);\n      }\n\n      return true;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"tryToUnmuteReplayVideo\", function () {\n      var video = _this.replayVideo;\n      video.muted = false;\n      var playPromise = video.play();\n\n      if (!playPromise) {\n        video.muted = true;\n        return;\n      }\n\n      playPromise.then(function () {\n        _this.setState({\n          isReplayVideoMuted: false\n        }); // fixes bug where seeking control during autoplay is not available until the video is almost completely played through\n\n\n        if (_this.props.replayVideoAutoplayAndLoopOff) {\n          video.pause();\n          video.loop = false;\n        }\n      }).catch(function (err) {\n        console.warn('Could not autoplay replay video', err);\n        video.muted = true;\n        return video.play();\n      }).catch(function (err) {\n        console.warn('Could play muted replay video after failed autoplay', err);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleDataAvailable\", function (event) {\n      if (_this.isDataHealthOK(event)) {\n        _this.recordedBlobs.push(event.data);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleStopRecording\", function () {\n      if (_this.props.onStopRecording) {\n        _this.props.onStopRecording();\n      }\n\n      if (!_this.mediaRecorder) {\n        _this.handleError(new _customErrors.ReactVideoRecorderMediaRecorderUnavailableError());\n\n        return;\n      }\n\n      _this.mediaRecorder.stop();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handlePauseRecording\", function () {\n      if (_this.props.onPauseRecording) {\n        _this.props.onPauseRecording();\n      }\n\n      if (!_this.mediaRecorder) {\n        _this.handleError(new _customErrors.ReactVideoRecorderMediaRecorderUnavailableError());\n\n        return;\n      }\n\n      _this.mediaRecorder.pause();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleResumeRecording\", function () {\n      if (_this.props.onResumeRecording) {\n        _this.props.onResumeRecording();\n      }\n\n      if (!_this.mediaRecorder) {\n        _this.handleError(new _customErrors.ReactVideoRecorderMediaRecorderUnavailableError());\n\n        return;\n      }\n\n      _this.mediaRecorder.resume();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleStartRecording\", function () {\n      if (_this.props.onStartRecording) {\n        _this.props.onStartRecording();\n      }\n\n      _this.setState({\n        isRunningCountdown: true,\n        isReplayingVideo: false\n      });\n\n      setTimeout(function () {\n        return _this.startRecording();\n      }, _this.props.countdownTime);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"startRecording\", function () {\n      (0, _getVideoInfo.captureThumb)(_this.cameraVideo).then(function (thumbnail) {\n        _this.thumbnail = thumbnail;\n        _this.recordedBlobs = [];\n        var options = {\n          mimeType: _this.getMimeType()\n        };\n\n        try {\n          _this.setState({\n            isRunningCountdown: false,\n            isRecording: true\n          });\n\n          _this.startedAt = new Date().getTime();\n          _this.mediaRecorder = new window.MediaRecorder(_this.stream, options);\n\n          _this.mediaRecorder.addEventListener('stop', _this.handleStop);\n\n          _this.mediaRecorder.addEventListener('error', _this.handleError);\n\n          _this.mediaRecorder.addEventListener('dataavailable', _this.handleDataAvailable);\n\n          var _this$props = _this.props,\n              timeLimit = _this$props.timeLimit,\n              chunkSize = _this$props.chunkSize,\n              dataAvailableTimeout = _this$props.dataAvailableTimeout;\n\n          _this.mediaRecorder.start(chunkSize); // collect 10ms of data\n\n\n          if (timeLimit) {\n            _this.timeLimitTimeout = setTimeout(function () {\n              _this.handleStopRecording();\n            }, timeLimit);\n          } // mediaRecorder.ondataavailable should be called every 10ms,\n          // as that's what we're passing to mediaRecorder.start() above\n\n\n          if (Number.isInteger(dataAvailableTimeout)) {\n            setTimeout(function () {\n              if (_this.recordedBlobs.length === 0) {\n                _this.handleError(new _customErrors.ReactVideoRecorderDataAvailableTimeoutError(dataAvailableTimeout));\n              }\n            }, dataAvailableTimeout);\n          }\n        } catch (err) {\n          console.error(\"Couldn't create MediaRecorder\", err, options);\n\n          _this.handleError(err);\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleStop\", function (event) {\n      var endedAt = new Date().getTime();\n\n      if (!_this.recordedBlobs || _this.recordedBlobs.length <= 0) {\n        var error = new _customErrors.ReactVideoRecorderRecordedBlobsUnavailableError(event);\n        console.error(error.message, event);\n\n        _this.handleError(error);\n\n        return;\n      }\n\n      clearTimeout(_this.timeLimitTimeout);\n      var videoBlob = _this.recordedBlobs.length === 1 ? _this.recordedBlobs[0] : new window.Blob(_this.recordedBlobs, {\n        type: _this.getMimeType()\n      });\n      var thumbnailBlob = _this.thumbnail;\n      var startedAt = _this.startedAt;\n      var duration = endedAt - startedAt; // if this gets executed too soon, the last chunk of data is lost on FF\n\n      _this.mediaRecorder.ondataavailable = null;\n\n      _this.fixVideoMetadata(videoBlob).then(function (fixedVideoBlob) {\n        _this.setState({\n          isRecording: false,\n          isReplayingVideo: true,\n          isReplayVideoMuted: true,\n          fixedVideoBlob: fixedVideoBlob,\n          videoUrl: window.URL.createObjectURL(fixedVideoBlob)\n        });\n\n        _this.turnOffCamera();\n\n        _this.props.onRecordingComplete(fixedVideoBlob, startedAt, thumbnailBlob, duration);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"fixVideoMetadata\", function (rawVideoBlob) {\n      var _Blob$prototype, _Blob$prototype$array; // see https://stackoverflow.com/a/63568311\n\n\n      (_Blob$prototype$array = (_Blob$prototype = Blob.prototype).arrayBuffer) !== null && _Blob$prototype$array !== void 0 ? _Blob$prototype$array : _Blob$prototype.arrayBuffer = function () {\n        return new Response(this).arrayBuffer();\n      };\n      return rawVideoBlob.arrayBuffer().then(function (buffer) {\n        var decoder = new _tsEbml.Decoder();\n        var elements = decoder.decode(buffer);\n        var reader = new _tsEbml.Reader();\n        reader.logging = false;\n        reader.drop_default_duration = false;\n        elements.forEach(function (element) {\n          return reader.read(element);\n        });\n        reader.stop();\n\n        var seekableMetadata = _tsEbml.tools.makeMetadataSeekable(reader.metadatas, reader.duration, reader.cues);\n\n        var blobBody = buffer.slice(reader.metadataSize);\n        var result = new Blob([seekableMetadata, blobBody], {\n          type: rawVideoBlob.type\n        });\n        return result;\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleVideoSelected\", function (e) {\n      if (_this.state.isReplayingVideo) {\n        _this.setState({\n          isReplayingVideo: false\n        });\n      }\n\n      var files = e.target.files || e.dataTransfer.files;\n      if (files.length === 0) return;\n      var startedAt = new Date().getTime();\n      var video = files[0];\n      e.target.value = null;\n      var extension = video.type === 'video/quicktime' ? 'mov' : undefined;\n      (0, _getVideoInfo.default)(video).then(function (_ref) {\n        var duration = _ref.duration,\n            thumbnail = _ref.thumbnail;\n\n        _this.setState({\n          isRecording: false,\n          isReplayingVideo: true,\n          isReplayVideoMuted: true,\n          videoBlob: video,\n          videoUrl: window.URL.createObjectURL(video)\n        });\n\n        _this.props.onRecordingComplete(video, startedAt, thumbnail, duration, extension);\n      }).catch(function (err) {\n        _this.handleError(err);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleOpenVideoInput\", function () {\n      if (_this.props.onOpenVideoInput) {\n        _this.props.onOpenVideoInput();\n      }\n\n      _this.videoInput.current.value = null;\n\n      _this.videoInput.current.click(); // fixes a bug on iPhone where it doesn't save the recorded video on the second time (if you press the 'Use another video' button)\n\n\n      _this.videoInput.current.addEventListener('change', _this.handleVideoSelected);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleStopReplaying\", function () {\n      if (_this.props.onStopReplaying) {\n        _this.props.onStopReplaying();\n      }\n\n      if (_this.props.useVideoInput && _this.props.isOnInitially) {\n        return _this.handleOpenVideoInput();\n      }\n\n      _this.setState({\n        isReplayingVideo: false\n      });\n\n      if (_this.state.isInlineRecordingSupported && _this.props.isOnInitially) {\n        _this.turnOnCamera();\n      } else if (_this.state.isVideoInputSupported && _this.props.isOnInitially) {\n        _this.handleOpenVideoInput();\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleReplayVideoClick\", function () {\n      if (_this.replayVideo.paused && !_this.props.showReplayControls) {\n        _this.replayVideo.play();\n      } // fixes bug where seeking control during autoplay is not available until the video is almost completely played through\n\n\n      if (!_this.props.replayVideoAutoplayAndLoopOff) {\n        _this.setState({\n          isReplayVideoMuted: !_this.state.isReplayVideoMuted\n        });\n      }\n    });\n\n    return _this;\n  }\n\n  _createClass(VideoRecorder, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var isInlineRecordingSupported = !!window.MediaSource && !!window.MediaRecorder && !!navigator.mediaDevices;\n      var isVideoInputSupported = document.createElement('input').capture !== undefined;\n\n      if (isInlineRecordingSupported) {\n        this.mediaSource = new window.MediaSource();\n      }\n\n      this.setState({\n        isInlineRecordingSupported: isInlineRecordingSupported,\n        isVideoInputSupported: isVideoInputSupported\n      }, function () {\n        if (_this2.props.useVideoInput && _this2.props.isOnInitially) {\n          _this2.handleOpenVideoInput();\n        } else if (_this2.state.isInlineRecordingSupported && _this2.props.isOnInitially) {\n          _this2.turnOnCamera();\n        } else if (_this2.state.isVideoInputSupported && _this2.props.isOnInitially) {\n          _this2.handleOpenVideoInput();\n        }\n      });\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      if (this.replayVideo && this.state.isReplayingVideo && !prevState.isReplayingVideo) {\n        this.tryToUnmuteReplayVideo();\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.turnOffCamera();\n    }\n  }, {\n    key: \"renderCameraView\",\n    value: function renderCameraView() {\n      var _this3 = this;\n\n      var _this$props2 = this.props,\n          showReplayControls = _this$props2.showReplayControls,\n          replayVideoAutoplayAndLoopOff = _this$props2.replayVideoAutoplayAndLoopOff,\n          renderDisconnectedView = _this$props2.renderDisconnectedView,\n          renderVideoInputView = _this$props2.renderVideoInputView,\n          renderUnsupportedView = _this$props2.renderUnsupportedView,\n          renderErrorView = _this$props2.renderErrorView,\n          renderLoadingView = _this$props2.renderLoadingView,\n          useVideoInput = _this$props2.useVideoInput;\n      var _this$state = this.state,\n          isVideoInputSupported = _this$state.isVideoInputSupported,\n          isReplayingVideo = _this$state.isReplayingVideo,\n          isInlineRecordingSupported = _this$state.isInlineRecordingSupported,\n          thereWasAnError = _this$state.thereWasAnError,\n          error = _this$state.error,\n          isCameraOn = _this$state.isCameraOn,\n          isConnecting = _this$state.isConnecting,\n          isReplayVideoMuted = _this$state.isReplayVideoMuted;\n      var shouldUseVideoInput = useVideoInput || !isInlineRecordingSupported && isVideoInputSupported;\n      var videoInput = shouldUseVideoInput ? /*#__PURE__*/_react.default.createElement(\"input\", {\n        ref: this.videoInput,\n        key: \"videoInput\",\n        type: \"file\",\n        accept: \"video/*\",\n        capture: useVideoInput ? undefined : 'user',\n        style: {\n          display: 'none'\n        },\n        onChange: this.handleVideoSelected\n      }) : null;\n\n      if (isReplayingVideo) {\n        return /*#__PURE__*/_react.default.createElement(CameraView, {\n          key: \"replay\"\n        }, /*#__PURE__*/_react.default.createElement(Video, {\n          ref: function ref(el) {\n            return _this3.replayVideo = el;\n          },\n          src: this.state.videoUrl,\n          loop: true,\n          muted: isReplayVideoMuted,\n          playsInline: true,\n          autoPlay: !replayVideoAutoplayAndLoopOff,\n          controls: showReplayControls,\n          onClick: this.handleReplayVideoClick,\n          onDurationChange: this.handleDurationChange\n        }), videoInput);\n      }\n\n      if (shouldUseVideoInput) {\n        return renderVideoInputView({\n          videoInput: videoInput\n        });\n      }\n\n      if (!isInlineRecordingSupported) {\n        return renderUnsupportedView();\n      }\n\n      if (thereWasAnError) {\n        return renderErrorView({\n          error: error\n        });\n      }\n\n      if (isCameraOn) {\n        return /*#__PURE__*/_react.default.createElement(CameraView, {\n          key: \"camera\"\n        }, /*#__PURE__*/_react.default.createElement(Video, {\n          isFlipped: this.props.isFlipped,\n          ref: function ref(el) {\n            return _this3.cameraVideo = el;\n          },\n          autoPlay: true,\n          muted: true\n        }));\n      }\n\n      if (isConnecting) {\n        return renderLoadingView();\n      }\n\n      return renderDisconnectedView();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state2 = this.state,\n          isVideoInputSupported = _this$state2.isVideoInputSupported,\n          isInlineRecordingSupported = _this$state2.isInlineRecordingSupported,\n          thereWasAnError = _this$state2.thereWasAnError,\n          isRecording = _this$state2.isRecording,\n          isCameraOn = _this$state2.isCameraOn,\n          streamIsReady = _this$state2.streamIsReady,\n          isConnecting = _this$state2.isConnecting,\n          isRunningCountdown = _this$state2.isRunningCountdown,\n          isReplayingVideo = _this$state2.isReplayingVideo,\n          isReplayVideoMuted = _this$state2.isReplayVideoMuted;\n      var _this$props3 = this.props,\n          countdownTime = _this$props3.countdownTime,\n          timeLimit = _this$props3.timeLimit,\n          showReplayControls = _this$props3.showReplayControls,\n          replayVideoAutoplayAndLoopOff = _this$props3.replayVideoAutoplayAndLoopOff,\n          renderActions = _this$props3.renderActions,\n          useVideoInput = _this$props3.useVideoInput;\n      return /*#__PURE__*/_react.default.createElement(Wrapper, null, this.renderCameraView(), renderActions({\n        isVideoInputSupported: isVideoInputSupported,\n        isInlineRecordingSupported: isInlineRecordingSupported,\n        thereWasAnError: thereWasAnError,\n        isRecording: isRecording,\n        isCameraOn: isCameraOn,\n        streamIsReady: streamIsReady,\n        isConnecting: isConnecting,\n        isRunningCountdown: isRunningCountdown,\n        isReplayingVideo: isReplayingVideo,\n        isReplayVideoMuted: isReplayVideoMuted,\n        countdownTime: countdownTime,\n        timeLimit: timeLimit,\n        showReplayControls: showReplayControls,\n        replayVideoAutoplayAndLoopOff: replayVideoAutoplayAndLoopOff,\n        useVideoInput: useVideoInput,\n        onTurnOnCamera: this.turnOnCamera,\n        onTurnOffCamera: this.turnOffCamera,\n        onOpenVideoInput: this.handleOpenVideoInput,\n        onStartRecording: this.handleStartRecording,\n        onStopRecording: this.handleStopRecording,\n        onPauseRecording: this.handlePauseRecording,\n        onResumeRecording: this.handleResumeRecording,\n        onStopReplaying: this.handleStopReplaying\n      }));\n    }\n  }]);\n\n  return VideoRecorder;\n}(_react.Component);\n\nexports.default = VideoRecorder;\n\n_defineProperty(VideoRecorder, \"propTypes\", {\n  /** Whether or not to start the camera initially */\n  isOnInitially: _propTypes.default.bool,\n\n  /** Whether or not to display the video flipped (makes sense for user facing camera) */\n  isFlipped: _propTypes.default.bool,\n\n  /** Pass this if you want to force a specific mime-type for the video */\n  mimeType: _propTypes.default.string,\n\n  /** How much time to wait until it starts recording (in ms) */\n  countdownTime: _propTypes.default.number,\n\n  /** Use this if you want to set a time limit for the video (in ms) */\n  timeLimit: _propTypes.default.number,\n\n  /** Use this if you want to show play/pause/etc. controls on the replay video */\n  showReplayControls: _propTypes.default.bool,\n\n  /** Use this to turn off autoplay and looping of the replay video. It is recommended to also showReplayControls in order to play */\n  replayVideoAutoplayAndLoopOff: _propTypes.default.bool,\n\n  /** Use this if you want to customize the constraints passed to getUserMedia() */\n  constraints: _propTypes.default.shape({\n    audio: _propTypes.default.any,\n    video: _propTypes.default.any\n  }),\n  chunkSize: _propTypes.default.number,\n  dataAvailableTimeout: _propTypes.default.number,\n  useVideoInput: _propTypes.default.bool,\n  renderDisconnectedView: _propTypes.default.func,\n  renderLoadingView: _propTypes.default.func,\n  renderVideoInputView: _propTypes.default.func,\n  renderUnsupportedView: _propTypes.default.func,\n  renderErrorView: _propTypes.default.func,\n  renderActions: _propTypes.default.func,\n  onCameraOn: _propTypes.default.func,\n  onTurnOnCamera: _propTypes.default.func,\n  onTurnOffCamera: _propTypes.default.func,\n  onStartRecording: _propTypes.default.func,\n  onStopRecording: _propTypes.default.func,\n  onPauseRecording: _propTypes.default.func,\n  onResumeRecording: _propTypes.default.func,\n  onRecordingComplete: _propTypes.default.func,\n  onOpenVideoInput: _propTypes.default.func,\n  onStopReplaying: _propTypes.default.func,\n  onError: _propTypes.default.func\n});\n\n_defineProperty(VideoRecorder, \"defaultProps\", {\n  renderUnsupportedView: function renderUnsupportedView() {\n    return /*#__PURE__*/_react.default.createElement(_unsupportedView.default, null);\n  },\n  renderErrorView: function renderErrorView() {\n    return /*#__PURE__*/_react.default.createElement(_errorView.default, null);\n  },\n  renderVideoInputView: function renderVideoInputView(_ref2) {\n    var videoInput = _ref2.videoInput;\n    return /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, videoInput);\n  },\n  renderDisconnectedView: function renderDisconnectedView() {\n    return /*#__PURE__*/_react.default.createElement(_disconnectedView.default, null);\n  },\n  renderLoadingView: function renderLoadingView() {\n    return /*#__PURE__*/_react.default.createElement(_loadingView.default, null);\n  },\n  renderActions: _renderActions.default,\n  isFlipped: true,\n  countdownTime: 3000,\n  constraints: CONSTRAINTS,\n  chunkSize: 250,\n  dataAvailableTimeout: 500\n});","map":{"version":3,"sources":["/Users/randyadams/IMMORTIFYV2/immortify-app-client/node_modules/react-video-recorder/lib/video-recorder.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","Object","defineProperty","exports","value","default","_react","_interopRequireWildcard","require","_propTypes","_interopRequireDefault","_styledComponents","_tsEbml","_unsupportedView","_errorView","_disconnectedView","_loadingView","_renderActions","_getVideoInfo","_customErrors","__esModule","_getRequireWildcardCache","WeakMap","cache","has","get","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","key","hasOwnProperty","call","desc","set","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","_createClass","protoProps","staticProps","_inherits","subClass","superClass","create","_setPrototypeOf","o","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","_getPrototypeOf","result","NewTarget","Reflect","construct","arguments","apply","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","sham","Proxy","Date","toString","e","getPrototypeOf","_defineProperty","MIME_TYPES","CONSTRAINTS","audio","video","Wrapper","div","withConfig","displayName","componentId","CameraView","Video","isFlipped","css","onClick","VideoRecorder","_Component","_super","_this","_len","args","Array","_key","concat","createRef","isRecording","isCameraOn","isConnecting","isReplayingVideo","isReplayVideoMuted","thereWasAnError","error","streamIsReady","isInlineRecordingSupported","isVideoInputSupported","stream","undefined","onTurnOnCamera","setState","fallbackContraints","navigator","mediaDevices","getUserMedia","constraints","catch","err","name","console","warn","then","handleSuccess","handleError","onTurnOffCamera","getTracks","forEach","stop","clearInterval","inactivityTimer","onCameraOn","window","URL","cameraVideo","srcObject","src","setTimeout","onError","clearTimeout","timeLimitTimeout","state","turnOffCamera","event","ReactVideoRecorderDataIssueError","message","mimeType","MediaRecorder","isTypeSupported","find","data","handleDataIssue","chunkSize","dataCheckInterval","blobCount","recordedBlobs","blob","Blob","type","getMimeType","size","replayVideo","muted","playPromise","play","replayVideoAutoplayAndLoopOff","pause","loop","isDataHealthOK","push","onStopRecording","mediaRecorder","ReactVideoRecorderMediaRecorderUnavailableError","onPauseRecording","onResumeRecording","resume","onStartRecording","isRunningCountdown","startRecording","countdownTime","captureThumb","thumbnail","options","startedAt","getTime","addEventListener","handleStop","handleDataAvailable","_this$props","timeLimit","dataAvailableTimeout","start","handleStopRecording","Number","isInteger","ReactVideoRecorderDataAvailableTimeoutError","endedAt","ReactVideoRecorderRecordedBlobsUnavailableError","videoBlob","thumbnailBlob","duration","ondataavailable","fixVideoMetadata","fixedVideoBlob","videoUrl","createObjectURL","onRecordingComplete","rawVideoBlob","_Blob$prototype","_Blob$prototype$array","arrayBuffer","Response","buffer","decoder","Decoder","elements","decode","reader","Reader","logging","drop_default_duration","element","read","seekableMetadata","tools","makeMetadataSeekable","metadatas","cues","blobBody","slice","metadataSize","files","dataTransfer","extension","_ref","onOpenVideoInput","videoInput","current","click","handleVideoSelected","onStopReplaying","useVideoInput","isOnInitially","handleOpenVideoInput","turnOnCamera","paused","showReplayControls","componentDidMount","_this2","MediaSource","document","createElement","capture","mediaSource","componentDidUpdate","prevProps","prevState","tryToUnmuteReplayVideo","componentWillUnmount","renderCameraView","_this3","_this$props2","renderDisconnectedView","renderVideoInputView","renderUnsupportedView","renderErrorView","renderLoadingView","_this$state","shouldUseVideoInput","ref","accept","style","display","onChange","el","playsInline","autoPlay","controls","handleReplayVideoClick","onDurationChange","handleDurationChange","render","_this$state2","_this$props3","renderActions","handleStartRecording","handlePauseRecording","handleResumeRecording","handleStopReplaying","Component","bool","string","number","shape","any","func","_ref2","Fragment"],"mappings":"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","sourcesContent":["\"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _styledComponents = _interopRequireWildcard(require(\"styled-components\"));\n\nvar _tsEbml = require(\"ts-ebml\");\n\nvar _unsupportedView = _interopRequireDefault(require(\"./defaults/unsupported-view\"));\n\nvar _errorView = _interopRequireDefault(require(\"./defaults/error-view\"));\n\nvar _disconnectedView = _interopRequireDefault(require(\"./defaults/disconnected-view\"));\n\nvar _loadingView = _interopRequireDefault(require(\"./defaults/loading-view\"));\n\nvar _renderActions = _interopRequireDefault(require(\"./defaults/render-actions\"));\n\nvar _getVideoInfo = _interopRequireWildcard(require(\"./get-video-info\"));\n\nvar _customErrors = require(\"./custom-errors\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _getRequireWildcardCache() { if (typeof WeakMap !== \"function\") return null; var cache = new WeakMap(); _getRequireWildcardCache = function _getRequireWildcardCache() { return cache; }; return cache; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar MIME_TYPES = ['video/webm;codecs=\"vp8,opus\"', 'video/webm;codecs=h264', 'video/webm;codecs=vp9', 'video/webm'];\nvar CONSTRAINTS = {\n  audio: true,\n  video: true\n};\n\nvar Wrapper = _styledComponents.default.div.withConfig({\n  displayName: \"video-recorder__Wrapper\",\n  componentId: \"sc-7k20rv-0\"\n})([\"position:relative;display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;height:100%;overflow:hidden;min-height:300px;background-color:#000;color:white;box-sizing:border-box;*{box-sizing:inherit;}\"]);\n\nvar CameraView = _styledComponents.default.div.withConfig({\n  displayName: \"video-recorder__CameraView\",\n  componentId: \"sc-7k20rv-1\"\n})([\"width:100%;height:100%;\"]);\n\nvar Video = _styledComponents.default.video.withConfig({\n  displayName: \"video-recorder__Video\",\n  componentId: \"sc-7k20rv-2\"\n})([\"position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);min-height:100%;min-width:100%;width:100%;height:100%;object-fit:cover;\", \";\", \";\"], function (props) {\n  return props.isFlipped && (0, _styledComponents.css)([\"transform:translate(-50%,-50%) scaleX(-1);\"]);\n}, function (props) {\n  return props.onClick && (0, _styledComponents.css)([\"cursor:pointer;\"]);\n});\n\nvar VideoRecorder = /*#__PURE__*/function (_Component) {\n  _inherits(VideoRecorder, _Component);\n\n  var _super = _createSuper(VideoRecorder);\n\n  function VideoRecorder() {\n    var _this;\n\n    _classCallCheck(this, VideoRecorder);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _defineProperty(_assertThisInitialized(_this), \"videoInput\", /*#__PURE__*/_react.default.createRef());\n\n    _defineProperty(_assertThisInitialized(_this), \"timeSinceInactivity\", 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      isRecording: false,\n      isCameraOn: false,\n      isConnecting: false,\n      isReplayingVideo: false,\n      isReplayVideoMuted: true,\n      thereWasAnError: false,\n      error: null,\n      streamIsReady: false,\n      isInlineRecordingSupported: null,\n      isVideoInputSupported: null,\n      stream: undefined\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"turnOnCamera\", function () {\n      if (_this.props.onTurnOnCamera) {\n        _this.props.onTurnOnCamera();\n      }\n\n      _this.setState({\n        isConnecting: true,\n        isReplayingVideo: false,\n        thereWasAnError: false,\n        error: null\n      });\n\n      var fallbackContraints = {\n        audio: true,\n        video: true\n      };\n      navigator.mediaDevices.getUserMedia(_this.props.constraints).catch(function (err) {\n        // there's a bug in chrome in some windows computers where using `ideal` in the constraints throws a NotReadableError\n        if (err.name === 'NotReadableError' || err.name === 'OverconstrainedError') {\n          console.warn(\"Got \".concat(err.name, \", trying getUserMedia again with fallback constraints\"));\n          return navigator.mediaDevices.getUserMedia(fallbackContraints);\n        }\n\n        throw err;\n      }).then(_this.handleSuccess).catch(_this.handleError);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"turnOffCamera\", function () {\n      if (_this.props.onTurnOffCamera) {\n        _this.props.onTurnOffCamera();\n      }\n\n      _this.stream && _this.stream.getTracks().forEach(function (stream) {\n        return stream.stop();\n      });\n\n      _this.setState({\n        isCameraOn: false\n      });\n\n      clearInterval(_this.inactivityTimer);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleSuccess\", function (stream) {\n      _this.stream = stream;\n\n      _this.setState({\n        isCameraOn: true,\n        stream: stream\n      });\n\n      if (_this.props.onCameraOn) {\n        _this.props.onCameraOn();\n      }\n\n      if (window.URL) {\n        _this.cameraVideo.srcObject = stream;\n      } else {\n        _this.cameraVideo.src = stream;\n      } // there is probably a better way\n      // but this makes sure the start recording button\n      // gives the stream a couple miliseconds to be ready\n\n\n      setTimeout(function () {\n        _this.setState({\n          isConnecting: false,\n          streamIsReady: true\n        });\n      }, 200);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleError\", function (err) {\n      var onError = _this.props.onError;\n      console.error('Captured error', err);\n      clearTimeout(_this.timeLimitTimeout);\n\n      if (onError) {\n        onError(err);\n      }\n\n      _this.setState({\n        isConnecting: _this.state.isConnecting && false,\n        isRecording: false,\n        thereWasAnError: true,\n        error: err\n      });\n\n      if (_this.state.isCameraOn) {\n        _this.turnOffCamera();\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleDataIssue\", function (event) {\n      var error = new _customErrors.ReactVideoRecorderDataIssueError(event);\n      console.error(error.message, event);\n\n      _this.handleError(error);\n\n      return false;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getMimeType\", function () {\n      if (_this.props.mimeType) {\n        return _this.props.mimeType;\n      }\n\n      var mimeType = window.MediaRecorder.isTypeSupported ? MIME_TYPES.find(window.MediaRecorder.isTypeSupported) : 'video/webm';\n      return mimeType || '';\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"isDataHealthOK\", function (event) {\n      if (!event.data) return _this.handleDataIssue(event);\n      var chunkSize = _this.props.chunkSize;\n      var dataCheckInterval = 2000 / chunkSize; // in some browsers (FF/S), data only shows up\n      // after a certain amount of time ~everyt 2 seconds\n\n      var blobCount = _this.recordedBlobs.length;\n\n      if (blobCount > dataCheckInterval && blobCount % dataCheckInterval === 0) {\n        var blob = new window.Blob(_this.recordedBlobs, {\n          type: _this.getMimeType()\n        });\n        if (blob.size <= 0) return _this.handleDataIssue(event);\n      }\n\n      return true;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"tryToUnmuteReplayVideo\", function () {\n      var video = _this.replayVideo;\n      video.muted = false;\n      var playPromise = video.play();\n\n      if (!playPromise) {\n        video.muted = true;\n        return;\n      }\n\n      playPromise.then(function () {\n        _this.setState({\n          isReplayVideoMuted: false\n        }); // fixes bug where seeking control during autoplay is not available until the video is almost completely played through\n\n\n        if (_this.props.replayVideoAutoplayAndLoopOff) {\n          video.pause();\n          video.loop = false;\n        }\n      }).catch(function (err) {\n        console.warn('Could not autoplay replay video', err);\n        video.muted = true;\n        return video.play();\n      }).catch(function (err) {\n        console.warn('Could play muted replay video after failed autoplay', err);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleDataAvailable\", function (event) {\n      if (_this.isDataHealthOK(event)) {\n        _this.recordedBlobs.push(event.data);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleStopRecording\", function () {\n      if (_this.props.onStopRecording) {\n        _this.props.onStopRecording();\n      }\n\n      if (!_this.mediaRecorder) {\n        _this.handleError(new _customErrors.ReactVideoRecorderMediaRecorderUnavailableError());\n\n        return;\n      }\n\n      _this.mediaRecorder.stop();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handlePauseRecording\", function () {\n      if (_this.props.onPauseRecording) {\n        _this.props.onPauseRecording();\n      }\n\n      if (!_this.mediaRecorder) {\n        _this.handleError(new _customErrors.ReactVideoRecorderMediaRecorderUnavailableError());\n\n        return;\n      }\n\n      _this.mediaRecorder.pause();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleResumeRecording\", function () {\n      if (_this.props.onResumeRecording) {\n        _this.props.onResumeRecording();\n      }\n\n      if (!_this.mediaRecorder) {\n        _this.handleError(new _customErrors.ReactVideoRecorderMediaRecorderUnavailableError());\n\n        return;\n      }\n\n      _this.mediaRecorder.resume();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleStartRecording\", function () {\n      if (_this.props.onStartRecording) {\n        _this.props.onStartRecording();\n      }\n\n      _this.setState({\n        isRunningCountdown: true,\n        isReplayingVideo: false\n      });\n\n      setTimeout(function () {\n        return _this.startRecording();\n      }, _this.props.countdownTime);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"startRecording\", function () {\n      (0, _getVideoInfo.captureThumb)(_this.cameraVideo).then(function (thumbnail) {\n        _this.thumbnail = thumbnail;\n        _this.recordedBlobs = [];\n        var options = {\n          mimeType: _this.getMimeType()\n        };\n\n        try {\n          _this.setState({\n            isRunningCountdown: false,\n            isRecording: true\n          });\n\n          _this.startedAt = new Date().getTime();\n          _this.mediaRecorder = new window.MediaRecorder(_this.stream, options);\n\n          _this.mediaRecorder.addEventListener('stop', _this.handleStop);\n\n          _this.mediaRecorder.addEventListener('error', _this.handleError);\n\n          _this.mediaRecorder.addEventListener('dataavailable', _this.handleDataAvailable);\n\n          var _this$props = _this.props,\n              timeLimit = _this$props.timeLimit,\n              chunkSize = _this$props.chunkSize,\n              dataAvailableTimeout = _this$props.dataAvailableTimeout;\n\n          _this.mediaRecorder.start(chunkSize); // collect 10ms of data\n\n\n          if (timeLimit) {\n            _this.timeLimitTimeout = setTimeout(function () {\n              _this.handleStopRecording();\n            }, timeLimit);\n          } // mediaRecorder.ondataavailable should be called every 10ms,\n          // as that's what we're passing to mediaRecorder.start() above\n\n\n          if (Number.isInteger(dataAvailableTimeout)) {\n            setTimeout(function () {\n              if (_this.recordedBlobs.length === 0) {\n                _this.handleError(new _customErrors.ReactVideoRecorderDataAvailableTimeoutError(dataAvailableTimeout));\n              }\n            }, dataAvailableTimeout);\n          }\n        } catch (err) {\n          console.error(\"Couldn't create MediaRecorder\", err, options);\n\n          _this.handleError(err);\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleStop\", function (event) {\n      var endedAt = new Date().getTime();\n\n      if (!_this.recordedBlobs || _this.recordedBlobs.length <= 0) {\n        var error = new _customErrors.ReactVideoRecorderRecordedBlobsUnavailableError(event);\n        console.error(error.message, event);\n\n        _this.handleError(error);\n\n        return;\n      }\n\n      clearTimeout(_this.timeLimitTimeout);\n      var videoBlob = _this.recordedBlobs.length === 1 ? _this.recordedBlobs[0] : new window.Blob(_this.recordedBlobs, {\n        type: _this.getMimeType()\n      });\n      var thumbnailBlob = _this.thumbnail;\n      var startedAt = _this.startedAt;\n      var duration = endedAt - startedAt; // if this gets executed too soon, the last chunk of data is lost on FF\n\n      _this.mediaRecorder.ondataavailable = null;\n\n      _this.fixVideoMetadata(videoBlob).then(function (fixedVideoBlob) {\n        _this.setState({\n          isRecording: false,\n          isReplayingVideo: true,\n          isReplayVideoMuted: true,\n          fixedVideoBlob: fixedVideoBlob,\n          videoUrl: window.URL.createObjectURL(fixedVideoBlob)\n        });\n\n        _this.turnOffCamera();\n\n        _this.props.onRecordingComplete(fixedVideoBlob, startedAt, thumbnailBlob, duration);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"fixVideoMetadata\", function (rawVideoBlob) {\n      var _Blob$prototype, _Blob$prototype$array;\n\n      // see https://stackoverflow.com/a/63568311\n      (_Blob$prototype$array = (_Blob$prototype = Blob.prototype).arrayBuffer) !== null && _Blob$prototype$array !== void 0 ? _Blob$prototype$array : _Blob$prototype.arrayBuffer = function () {\n        return new Response(this).arrayBuffer();\n      };\n      return rawVideoBlob.arrayBuffer().then(function (buffer) {\n        var decoder = new _tsEbml.Decoder();\n        var elements = decoder.decode(buffer);\n        var reader = new _tsEbml.Reader();\n        reader.logging = false;\n        reader.drop_default_duration = false;\n        elements.forEach(function (element) {\n          return reader.read(element);\n        });\n        reader.stop();\n\n        var seekableMetadata = _tsEbml.tools.makeMetadataSeekable(reader.metadatas, reader.duration, reader.cues);\n\n        var blobBody = buffer.slice(reader.metadataSize);\n        var result = new Blob([seekableMetadata, blobBody], {\n          type: rawVideoBlob.type\n        });\n        return result;\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleVideoSelected\", function (e) {\n      if (_this.state.isReplayingVideo) {\n        _this.setState({\n          isReplayingVideo: false\n        });\n      }\n\n      var files = e.target.files || e.dataTransfer.files;\n      if (files.length === 0) return;\n      var startedAt = new Date().getTime();\n      var video = files[0];\n      e.target.value = null;\n      var extension = video.type === 'video/quicktime' ? 'mov' : undefined;\n      (0, _getVideoInfo.default)(video).then(function (_ref) {\n        var duration = _ref.duration,\n            thumbnail = _ref.thumbnail;\n\n        _this.setState({\n          isRecording: false,\n          isReplayingVideo: true,\n          isReplayVideoMuted: true,\n          videoBlob: video,\n          videoUrl: window.URL.createObjectURL(video)\n        });\n\n        _this.props.onRecordingComplete(video, startedAt, thumbnail, duration, extension);\n      }).catch(function (err) {\n        _this.handleError(err);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleOpenVideoInput\", function () {\n      if (_this.props.onOpenVideoInput) {\n        _this.props.onOpenVideoInput();\n      }\n\n      _this.videoInput.current.value = null;\n\n      _this.videoInput.current.click(); // fixes a bug on iPhone where it doesn't save the recorded video on the second time (if you press the 'Use another video' button)\n\n\n      _this.videoInput.current.addEventListener('change', _this.handleVideoSelected);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleStopReplaying\", function () {\n      if (_this.props.onStopReplaying) {\n        _this.props.onStopReplaying();\n      }\n\n      if (_this.props.useVideoInput && _this.props.isOnInitially) {\n        return _this.handleOpenVideoInput();\n      }\n\n      _this.setState({\n        isReplayingVideo: false\n      });\n\n      if (_this.state.isInlineRecordingSupported && _this.props.isOnInitially) {\n        _this.turnOnCamera();\n      } else if (_this.state.isVideoInputSupported && _this.props.isOnInitially) {\n        _this.handleOpenVideoInput();\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleReplayVideoClick\", function () {\n      if (_this.replayVideo.paused && !_this.props.showReplayControls) {\n        _this.replayVideo.play();\n      } // fixes bug where seeking control during autoplay is not available until the video is almost completely played through\n\n\n      if (!_this.props.replayVideoAutoplayAndLoopOff) {\n        _this.setState({\n          isReplayVideoMuted: !_this.state.isReplayVideoMuted\n        });\n      }\n    });\n\n    return _this;\n  }\n\n  _createClass(VideoRecorder, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var isInlineRecordingSupported = !!window.MediaSource && !!window.MediaRecorder && !!navigator.mediaDevices;\n      var isVideoInputSupported = document.createElement('input').capture !== undefined;\n\n      if (isInlineRecordingSupported) {\n        this.mediaSource = new window.MediaSource();\n      }\n\n      this.setState({\n        isInlineRecordingSupported: isInlineRecordingSupported,\n        isVideoInputSupported: isVideoInputSupported\n      }, function () {\n        if (_this2.props.useVideoInput && _this2.props.isOnInitially) {\n          _this2.handleOpenVideoInput();\n        } else if (_this2.state.isInlineRecordingSupported && _this2.props.isOnInitially) {\n          _this2.turnOnCamera();\n        } else if (_this2.state.isVideoInputSupported && _this2.props.isOnInitially) {\n          _this2.handleOpenVideoInput();\n        }\n      });\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      if (this.replayVideo && this.state.isReplayingVideo && !prevState.isReplayingVideo) {\n        this.tryToUnmuteReplayVideo();\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.turnOffCamera();\n    }\n  }, {\n    key: \"renderCameraView\",\n    value: function renderCameraView() {\n      var _this3 = this;\n\n      var _this$props2 = this.props,\n          showReplayControls = _this$props2.showReplayControls,\n          replayVideoAutoplayAndLoopOff = _this$props2.replayVideoAutoplayAndLoopOff,\n          renderDisconnectedView = _this$props2.renderDisconnectedView,\n          renderVideoInputView = _this$props2.renderVideoInputView,\n          renderUnsupportedView = _this$props2.renderUnsupportedView,\n          renderErrorView = _this$props2.renderErrorView,\n          renderLoadingView = _this$props2.renderLoadingView,\n          useVideoInput = _this$props2.useVideoInput;\n      var _this$state = this.state,\n          isVideoInputSupported = _this$state.isVideoInputSupported,\n          isReplayingVideo = _this$state.isReplayingVideo,\n          isInlineRecordingSupported = _this$state.isInlineRecordingSupported,\n          thereWasAnError = _this$state.thereWasAnError,\n          error = _this$state.error,\n          isCameraOn = _this$state.isCameraOn,\n          isConnecting = _this$state.isConnecting,\n          isReplayVideoMuted = _this$state.isReplayVideoMuted;\n      var shouldUseVideoInput = useVideoInput || !isInlineRecordingSupported && isVideoInputSupported;\n      var videoInput = shouldUseVideoInput ? /*#__PURE__*/_react.default.createElement(\"input\", {\n        ref: this.videoInput,\n        key: \"videoInput\",\n        type: \"file\",\n        accept: \"video/*\",\n        capture: useVideoInput ? undefined : 'user',\n        style: {\n          display: 'none'\n        },\n        onChange: this.handleVideoSelected\n      }) : null;\n\n      if (isReplayingVideo) {\n        return /*#__PURE__*/_react.default.createElement(CameraView, {\n          key: \"replay\"\n        }, /*#__PURE__*/_react.default.createElement(Video, {\n          ref: function ref(el) {\n            return _this3.replayVideo = el;\n          },\n          src: this.state.videoUrl,\n          loop: true,\n          muted: isReplayVideoMuted,\n          playsInline: true,\n          autoPlay: !replayVideoAutoplayAndLoopOff,\n          controls: showReplayControls,\n          onClick: this.handleReplayVideoClick,\n          onDurationChange: this.handleDurationChange\n        }), videoInput);\n      }\n\n      if (shouldUseVideoInput) {\n        return renderVideoInputView({\n          videoInput: videoInput\n        });\n      }\n\n      if (!isInlineRecordingSupported) {\n        return renderUnsupportedView();\n      }\n\n      if (thereWasAnError) {\n        return renderErrorView({\n          error: error\n        });\n      }\n\n      if (isCameraOn) {\n        return /*#__PURE__*/_react.default.createElement(CameraView, {\n          key: \"camera\"\n        }, /*#__PURE__*/_react.default.createElement(Video, {\n          isFlipped: this.props.isFlipped,\n          ref: function ref(el) {\n            return _this3.cameraVideo = el;\n          },\n          autoPlay: true,\n          muted: true\n        }));\n      }\n\n      if (isConnecting) {\n        return renderLoadingView();\n      }\n\n      return renderDisconnectedView();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state2 = this.state,\n          isVideoInputSupported = _this$state2.isVideoInputSupported,\n          isInlineRecordingSupported = _this$state2.isInlineRecordingSupported,\n          thereWasAnError = _this$state2.thereWasAnError,\n          isRecording = _this$state2.isRecording,\n          isCameraOn = _this$state2.isCameraOn,\n          streamIsReady = _this$state2.streamIsReady,\n          isConnecting = _this$state2.isConnecting,\n          isRunningCountdown = _this$state2.isRunningCountdown,\n          isReplayingVideo = _this$state2.isReplayingVideo,\n          isReplayVideoMuted = _this$state2.isReplayVideoMuted;\n      var _this$props3 = this.props,\n          countdownTime = _this$props3.countdownTime,\n          timeLimit = _this$props3.timeLimit,\n          showReplayControls = _this$props3.showReplayControls,\n          replayVideoAutoplayAndLoopOff = _this$props3.replayVideoAutoplayAndLoopOff,\n          renderActions = _this$props3.renderActions,\n          useVideoInput = _this$props3.useVideoInput;\n      return /*#__PURE__*/_react.default.createElement(Wrapper, null, this.renderCameraView(), renderActions({\n        isVideoInputSupported: isVideoInputSupported,\n        isInlineRecordingSupported: isInlineRecordingSupported,\n        thereWasAnError: thereWasAnError,\n        isRecording: isRecording,\n        isCameraOn: isCameraOn,\n        streamIsReady: streamIsReady,\n        isConnecting: isConnecting,\n        isRunningCountdown: isRunningCountdown,\n        isReplayingVideo: isReplayingVideo,\n        isReplayVideoMuted: isReplayVideoMuted,\n        countdownTime: countdownTime,\n        timeLimit: timeLimit,\n        showReplayControls: showReplayControls,\n        replayVideoAutoplayAndLoopOff: replayVideoAutoplayAndLoopOff,\n        useVideoInput: useVideoInput,\n        onTurnOnCamera: this.turnOnCamera,\n        onTurnOffCamera: this.turnOffCamera,\n        onOpenVideoInput: this.handleOpenVideoInput,\n        onStartRecording: this.handleStartRecording,\n        onStopRecording: this.handleStopRecording,\n        onPauseRecording: this.handlePauseRecording,\n        onResumeRecording: this.handleResumeRecording,\n        onStopReplaying: this.handleStopReplaying\n      }));\n    }\n  }]);\n\n  return VideoRecorder;\n}(_react.Component);\n\nexports.default = VideoRecorder;\n\n_defineProperty(VideoRecorder, \"propTypes\", {\n  /** Whether or not to start the camera initially */\n  isOnInitially: _propTypes.default.bool,\n\n  /** Whether or not to display the video flipped (makes sense for user facing camera) */\n  isFlipped: _propTypes.default.bool,\n\n  /** Pass this if you want to force a specific mime-type for the video */\n  mimeType: _propTypes.default.string,\n\n  /** How much time to wait until it starts recording (in ms) */\n  countdownTime: _propTypes.default.number,\n\n  /** Use this if you want to set a time limit for the video (in ms) */\n  timeLimit: _propTypes.default.number,\n\n  /** Use this if you want to show play/pause/etc. controls on the replay video */\n  showReplayControls: _propTypes.default.bool,\n\n  /** Use this to turn off autoplay and looping of the replay video. It is recommended to also showReplayControls in order to play */\n  replayVideoAutoplayAndLoopOff: _propTypes.default.bool,\n\n  /** Use this if you want to customize the constraints passed to getUserMedia() */\n  constraints: _propTypes.default.shape({\n    audio: _propTypes.default.any,\n    video: _propTypes.default.any\n  }),\n  chunkSize: _propTypes.default.number,\n  dataAvailableTimeout: _propTypes.default.number,\n  useVideoInput: _propTypes.default.bool,\n  renderDisconnectedView: _propTypes.default.func,\n  renderLoadingView: _propTypes.default.func,\n  renderVideoInputView: _propTypes.default.func,\n  renderUnsupportedView: _propTypes.default.func,\n  renderErrorView: _propTypes.default.func,\n  renderActions: _propTypes.default.func,\n  onCameraOn: _propTypes.default.func,\n  onTurnOnCamera: _propTypes.default.func,\n  onTurnOffCamera: _propTypes.default.func,\n  onStartRecording: _propTypes.default.func,\n  onStopRecording: _propTypes.default.func,\n  onPauseRecording: _propTypes.default.func,\n  onResumeRecording: _propTypes.default.func,\n  onRecordingComplete: _propTypes.default.func,\n  onOpenVideoInput: _propTypes.default.func,\n  onStopReplaying: _propTypes.default.func,\n  onError: _propTypes.default.func\n});\n\n_defineProperty(VideoRecorder, \"defaultProps\", {\n  renderUnsupportedView: function renderUnsupportedView() {\n    return /*#__PURE__*/_react.default.createElement(_unsupportedView.default, null);\n  },\n  renderErrorView: function renderErrorView() {\n    return /*#__PURE__*/_react.default.createElement(_errorView.default, null);\n  },\n  renderVideoInputView: function renderVideoInputView(_ref2) {\n    var videoInput = _ref2.videoInput;\n    return /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, videoInput);\n  },\n  renderDisconnectedView: function renderDisconnectedView() {\n    return /*#__PURE__*/_react.default.createElement(_disconnectedView.default, null);\n  },\n  renderLoadingView: function renderLoadingView() {\n    return /*#__PURE__*/_react.default.createElement(_loadingView.default, null);\n  },\n  renderActions: _renderActions.default,\n  isFlipped: true,\n  countdownTime: 3000,\n  constraints: CONSTRAINTS,\n  chunkSize: 250,\n  dataAvailableTimeout: 500\n});"]},"metadata":{},"sourceType":"script"}