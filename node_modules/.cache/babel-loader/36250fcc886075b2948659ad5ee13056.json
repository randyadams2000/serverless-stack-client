{"ast":null,"code":"import _regeneratorRuntime from\"/Users/randyadams/IMMORTIFYV2/immortify-app-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/randyadams/IMMORTIFYV2/immortify-app-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/randyadams/IMMORTIFYV2/immortify-app-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useRef,useState}from\"react\";import{useHistory}from\"react-router-dom\";import{FormGroup,FormControl,ControlLabel}from\"react-bootstrap\";import LoaderButton from\"../components/LoaderButton\";import{onError}from\"../libs/errorLib\";import config from\"../config\";import\"./NewNote.css\";import{API}from\"aws-amplify\";import{s3Upload}from\"../libs/awsLib\";export default function NewNote(){var file=useRef(null);var history=useHistory();var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),content=_useState2[0],setContent=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];function validateForm(){return content.length>0;}function handleFileChange(event){file.current=event.target.files[0];}function handleSubmit(_x){return _handleSubmit.apply(this,arguments);}function _handleSubmit(){_handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var attachment;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();if(!(file.current&&file.current.size>config.MAX_ATTACHMENT_SIZE)){_context.next=4;break;}alert(\"Please pick a file smaller than \".concat(config.MAX_ATTACHMENT_SIZE/1000000,\" MB.\"));return _context.abrupt(\"return\");case 4:setIsLoading(true);_context.prev=5;if(!file.current){_context.next=12;break;}_context.next=9;return s3Upload(file.current);case 9:_context.t0=_context.sent;_context.next=13;break;case 12:_context.t0=null;case 13:attachment=_context.t0;_context.next=16;return createNote({content:content,attachment:attachment});case 16:history.push(\"/\");_context.next=23;break;case 19:_context.prev=19;_context.t1=_context[\"catch\"](5);onError(_context.t1);setIsLoading(false);case 23:case\"end\":return _context.stop();}}},_callee,null,[[5,19]]);}));return _handleSubmit.apply(this,arguments);}function createNote(note){return API.post(\"notes\",\"/notes\",{body:note});}return/*#__PURE__*/React.createElement(\"div\",{className:\"NewNote\"},/*#__PURE__*/React.createElement(\"form\",{onSubmit:handleSubmit},/*#__PURE__*/React.createElement(FormGroup,{controlId:\"content\"},/*#__PURE__*/React.createElement(FormControl,{value:content,componentClass:\"textarea\",onChange:function onChange(e){return setContent(e.target.value);}})),/*#__PURE__*/React.createElement(FormGroup,{controlId:\"file\"},/*#__PURE__*/React.createElement(ControlLabel,null,\"Attachment\"),/*#__PURE__*/React.createElement(FormControl,{onChange:handleFileChange,type:\"file\"})),/*#__PURE__*/React.createElement(LoaderButton,{block:true,type:\"submit\",bsSize:\"large\",bsStyle:\"primary\",isLoading:isLoading,disabled:!validateForm()},\"Create\")));}","map":{"version":3,"sources":["/Users/randyadams/IMMORTIFYV2/immortify-app-client/src/containers/NewNote.js"],"names":["React","useRef","useState","useHistory","FormGroup","FormControl","ControlLabel","LoaderButton","onError","config","API","s3Upload","NewNote","file","history","content","setContent","isLoading","setIsLoading","validateForm","length","handleFileChange","event","current","target","files","handleSubmit","preventDefault","size","MAX_ATTACHMENT_SIZE","alert","attachment","createNote","push","note","post","body","e","value"],"mappings":"wfAAA,MAAOA,CAAAA,KAAP,EAAgBC,MAAhB,CAAwBC,QAAxB,KAAwC,OAAxC,CACA,OAASC,UAAT,KAA2B,kBAA3B,CACA,OAASC,SAAT,CAAoBC,WAApB,CAAiCC,YAAjC,KAAqD,iBAArD,CACA,MAAOC,CAAAA,YAAP,KAAyB,4BAAzB,CACA,OAASC,OAAT,KAAwB,kBAAxB,CACA,MAAOC,CAAAA,MAAP,KAAmB,WAAnB,CACA,MAAO,eAAP,CACA,OAASC,GAAT,KAAoB,aAApB,CACA,OAASC,QAAT,KAAyB,gBAAzB,CAGA,cAAe,SAASC,CAAAA,OAAT,EAAmB,CAChC,GAAMC,CAAAA,IAAI,CAAGZ,MAAM,CAAC,IAAD,CAAnB,CACA,GAAMa,CAAAA,OAAO,CAAGX,UAAU,EAA1B,CAFgC,cAGFD,QAAQ,CAAC,EAAD,CAHN,wCAGzBa,OAHyB,eAGhBC,UAHgB,8BAIEd,QAAQ,CAAC,KAAD,CAJV,yCAIzBe,SAJyB,eAIdC,YAJc,eAMhC,QAASC,CAAAA,YAAT,EAAwB,CACtB,MAAOJ,CAAAA,OAAO,CAACK,MAAR,CAAiB,CAAxB,CACD,CAED,QAASC,CAAAA,gBAAT,CAA0BC,KAA1B,CAAiC,CAC/BT,IAAI,CAACU,OAAL,CAAeD,KAAK,CAACE,MAAN,CAAaC,KAAb,CAAmB,CAAnB,CAAf,CACD,CAZ+B,QAclBC,CAAAA,YAdkB,gJAcjC,iBAA4BJ,KAA5B,iIACCA,KAAK,CAACK,cAAN,GADD,KAGKd,IAAI,CAACU,OAAL,EAAgBV,IAAI,CAACU,OAAL,CAAaK,IAAb,CAAoBnB,MAAM,CAACoB,mBAHhD,0BAIGC,KAAK,2CACgCrB,MAAM,CAACoB,mBAAP,CACjC,OAFC,SAAL,CAJH,wCAWCX,YAAY,CAAC,IAAD,CAAZ,CAXD,oBAcsBL,IAAI,CAACU,OAd3B,gDAc2CZ,CAAAA,QAAQ,CAACE,IAAI,CAACU,OAAN,CAdnD,6EAcoE,IAdpE,SAcSQ,UAdT,oCAeSC,CAAAA,UAAU,CAAC,CAAEjB,OAAO,CAAPA,OAAF,CAAWgB,UAAU,CAAVA,UAAX,CAAD,CAfnB,SAgBGjB,OAAO,CAACmB,IAAR,CAAa,GAAb,EAhBH,iFAkBGzB,OAAO,aAAP,CACAU,YAAY,CAAC,KAAD,CAAZ,CAnBH,qEAdiC,+CAqClC,QAASc,CAAAA,UAAT,CAAoBE,IAApB,CAA0B,CACxB,MAAOxB,CAAAA,GAAG,CAACyB,IAAJ,CAAS,OAAT,CAAkB,QAAlB,CAA4B,CACjCC,IAAI,CAAEF,IAD2B,CAA5B,CAAP,CAGD,CAEC,mBACE,2BAAK,SAAS,CAAC,SAAf,eACE,4BAAM,QAAQ,CAAER,YAAhB,eACE,oBAAC,SAAD,EAAW,SAAS,CAAC,SAArB,eACE,oBAAC,WAAD,EACE,KAAK,CAAEX,OADT,CAEE,cAAc,CAAC,UAFjB,CAGE,QAAQ,CAAE,kBAAAsB,CAAC,QAAIrB,CAAAA,UAAU,CAACqB,CAAC,CAACb,MAAF,CAASc,KAAV,CAAd,EAHb,EADF,CADF,cAQE,oBAAC,SAAD,EAAW,SAAS,CAAC,MAArB,eACE,oBAAC,YAAD,mBADF,cAEE,oBAAC,WAAD,EAAa,QAAQ,CAAEjB,gBAAvB,CAAyC,IAAI,CAAC,MAA9C,EAFF,CARF,cAYE,oBAAC,YAAD,EACE,KAAK,KADP,CAEE,IAAI,CAAC,QAFP,CAGE,MAAM,CAAC,OAHT,CAIE,OAAO,CAAC,SAJV,CAKE,SAAS,CAAEJ,SALb,CAME,QAAQ,CAAE,CAACE,YAAY,EANzB,WAZF,CADF,CADF,CA2BD","sourcesContent":["import React, { useRef, useState } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { FormGroup, FormControl, ControlLabel } from \"react-bootstrap\";\nimport LoaderButton from \"../components/LoaderButton\";\nimport { onError } from \"../libs/errorLib\";\nimport config from \"../config\";\nimport \"./NewNote.css\";\nimport { API } from \"aws-amplify\";\nimport { s3Upload } from \"../libs/awsLib\";\n\n\nexport default function NewNote() {\n  const file = useRef(null);\n  const history = useHistory();\n  const [content, setContent] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n\n  function validateForm() {\n    return content.length > 0;\n  }\n\n  function handleFileChange(event) {\n    file.current = event.target.files[0];\n  }\n\n async function handleSubmit(event) {\n  event.preventDefault();\n\n  if (file.current && file.current.size > config.MAX_ATTACHMENT_SIZE) {\n    alert(\n      `Please pick a file smaller than ${config.MAX_ATTACHMENT_SIZE /\n        1000000} MB.`\n    );\n    return;\n  }\n\n  setIsLoading(true);\n\n  try {\n    const attachment = file.current ? await s3Upload(file.current) : null;\n    await createNote({ content, attachment });\n    history.push(\"/\");\n  } catch (e) {\n    onError(e);\n    setIsLoading(false);\n  }\n}\n\nfunction createNote(note) {\n  return API.post(\"notes\", \"/notes\", {\n    body: note\n  });\n}\n\n  return (\n    <div className=\"NewNote\">\n      <form onSubmit={handleSubmit}>\n        <FormGroup controlId=\"content\">\n          <FormControl\n            value={content}\n            componentClass=\"textarea\"\n            onChange={e => setContent(e.target.value)}\n          />\n        </FormGroup>\n        <FormGroup controlId=\"file\">\n          <ControlLabel>Attachment</ControlLabel>\n          <FormControl onChange={handleFileChange} type=\"file\" />\n        </FormGroup>\n        <LoaderButton\n          block\n          type=\"submit\"\n          bsSize=\"large\"\n          bsStyle=\"primary\"\n          isLoading={isLoading}\n          disabled={!validateForm()}\n        >\n          Create\n        </LoaderButton>\n      </form>\n    </div>\n  );\n}"]},"metadata":{},"sourceType":"module"}