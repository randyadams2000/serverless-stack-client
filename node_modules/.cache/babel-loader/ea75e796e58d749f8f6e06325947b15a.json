{"ast":null,"code":"\"use strict\";function _typeof(obj){\"@babel/helpers - typeof\";if(typeof Symbol===\"function\"&&typeof Symbol.iterator===\"symbol\"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol===\"function\"&&obj.constructor===Symbol&&obj!==Symbol.prototype?\"symbol\":typeof obj;};}return _typeof(obj);}Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var _react=_interopRequireWildcard(require(\"react\"));var _propTypes=_interopRequireDefault(require(\"prop-types\"));var _styledComponents=_interopRequireWildcard(require(\"styled-components\"));var _tsEbml=require(\"ts-ebml\");var _unsupportedView=_interopRequireDefault(require(\"./defaults/unsupported-view\"));var _errorView=_interopRequireDefault(require(\"./defaults/error-view\"));var _disconnectedView=_interopRequireDefault(require(\"./defaults/disconnected-view\"));var _loadingView=_interopRequireDefault(require(\"./defaults/loading-view\"));var _renderActions=_interopRequireDefault(require(\"./defaults/render-actions\"));var _getVideoInfo=_interopRequireWildcard(require(\"./get-video-info\"));var _customErrors=require(\"./custom-errors\");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _getRequireWildcardCache(){if(typeof WeakMap!==\"function\")return null;var cache=new WeakMap();_getRequireWildcardCache=function _getRequireWildcardCache(){return cache;};return cache;}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}if(obj===null||_typeof(obj)!==\"object\"&&typeof obj!==\"function\"){return{default:obj};}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj);}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}newObj.default=obj;if(cache){cache.set(obj,newObj);}return newObj;}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError(\"Cannot call a class as a function\");}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if(\"value\"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}function _inherits(subClass,superClass){if(typeof superClass!==\"function\"&&superClass!==null){throw new TypeError(\"Super expression must either be null or a function\");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass);}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)===\"object\"||typeof call===\"function\")){return call;}return _assertThisInitialized(self);}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");}return self;}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}var MIME_TYPES=['video/webm;codecs=\"vp8,opus\"','video/webm;codecs=h264','video/webm;codecs=vp9','video/webm'];var CONSTRAINTS={audio:true,video:true};var Wrapper=_styledComponents.default.div.withConfig({displayName:\"video-recorder__Wrapper\",componentId:\"sc-7k20rv-0\"})([\"position:relative;display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;height:100%;overflow:hidden;min-height:300px;background-color:#000;color:white;box-sizing:border-box;*{box-sizing:inherit;}\"]);var CameraView=_styledComponents.default.div.withConfig({displayName:\"video-recorder__CameraView\",componentId:\"sc-7k20rv-1\"})([\"width:100%;height:100%;\"]);var Video=_styledComponents.default.video.withConfig({displayName:\"video-recorder__Video\",componentId:\"sc-7k20rv-2\"})([\"position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);min-height:100%;min-width:100%;width:100%;height:100%;object-fit:cover;\",\";\",\";\"],function(props){return props.isFlipped&&(0,_styledComponents.css)([\"transform:translate(-50%,-50%) scaleX(-1);\"]);},function(props){return props.onClick&&(0,_styledComponents.css)([\"cursor:pointer;\"]);});var VideoRecorder=/*#__PURE__*/function(_Component){_inherits(VideoRecorder,_Component);var _super=_createSuper(VideoRecorder);function VideoRecorder(){var _this;_classCallCheck(this,VideoRecorder);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_defineProperty(_assertThisInitialized(_this),\"videoInput\",/*#__PURE__*/_react.default.createRef());_defineProperty(_assertThisInitialized(_this),\"timeSinceInactivity\",0);_defineProperty(_assertThisInitialized(_this),\"state\",{isRecording:false,isCameraOn:false,isConnecting:false,isReplayingVideo:false,isReplayVideoMuted:true,thereWasAnError:false,error:null,streamIsReady:false,isInlineRecordingSupported:null,isVideoInputSupported:null,stream:undefined});_defineProperty(_assertThisInitialized(_this),\"turnOnCamera\",function(){if(_this.props.onTurnOnCamera){_this.props.onTurnOnCamera();}_this.setState({isConnecting:true,isReplayingVideo:false,thereWasAnError:false,error:null});var fallbackContraints={audio:true,video:true};navigator.mediaDevices.getUserMedia(_this.props.constraints).catch(function(err){// there's a bug in chrome in some windows computers where using `ideal` in the constraints throws a NotReadableError\nif(err.name==='NotReadableError'||err.name==='OverconstrainedError'){console.warn(\"Got \".concat(err.name,\", trying getUserMedia again with fallback constraints\"));return navigator.mediaDevices.getUserMedia(fallbackContraints);}throw err;}).then(_this.handleSuccess).catch(_this.handleError);});_defineProperty(_assertThisInitialized(_this),\"turnOffCamera\",function(){if(_this.props.onTurnOffCamera){_this.props.onTurnOffCamera();}_this.stream&&_this.stream.getTracks().forEach(function(stream){return stream.stop();});_this.setState({isCameraOn:false});clearInterval(_this.inactivityTimer);});_defineProperty(_assertThisInitialized(_this),\"handleSuccess\",function(stream){_this.stream=stream;_this.setState({isCameraOn:true,stream:stream});if(_this.props.onCameraOn){_this.props.onCameraOn();}if(window.URL){_this.cameraVideo.srcObject=stream;}else{_this.cameraVideo.src=stream;}// there is probably a better way\n// but this makes sure the start recording button\n// gives the stream a couple miliseconds to be ready\nsetTimeout(function(){_this.setState({isConnecting:false,streamIsReady:true});},200);});_defineProperty(_assertThisInitialized(_this),\"handleError\",function(err){var onError=_this.props.onError;console.error('Captured error',err);clearTimeout(_this.timeLimitTimeout);if(onError){onError(err);}_this.setState({isConnecting:_this.state.isConnecting&&false,isRecording:false,thereWasAnError:true,error:err});if(_this.state.isCameraOn){_this.turnOffCamera();}});_defineProperty(_assertThisInitialized(_this),\"handleDataIssue\",function(event){var error=new _customErrors.ReactVideoRecorderDataIssueError(event);console.error(error.message,event);_this.handleError(error);return false;});_defineProperty(_assertThisInitialized(_this),\"getMimeType\",function(){if(_this.props.mimeType){return _this.props.mimeType;}var mimeType=window.MediaRecorder.isTypeSupported?MIME_TYPES.find(window.MediaRecorder.isTypeSupported):'video/webm';return mimeType||'';});_defineProperty(_assertThisInitialized(_this),\"isDataHealthOK\",function(event){if(!event.data)return _this.handleDataIssue(event);var chunkSize=_this.props.chunkSize;var dataCheckInterval=2000/chunkSize;// in some browsers (FF/S), data only shows up\n// after a certain amount of time ~everyt 2 seconds\nvar blobCount=_this.recordedBlobs.length;if(blobCount>dataCheckInterval&&blobCount%dataCheckInterval===0){var blob=new window.Blob(_this.recordedBlobs,{type:_this.getMimeType()});if(blob.size<=0)return _this.handleDataIssue(event);}return true;});_defineProperty(_assertThisInitialized(_this),\"tryToUnmuteReplayVideo\",function(){var video=_this.replayVideo;video.muted=false;var playPromise=video.play();if(!playPromise){video.muted=true;return;}playPromise.then(function(){_this.setState({isReplayVideoMuted:false});// fixes bug where seeking control during autoplay is not available until the video is almost completely played through\nif(_this.props.replayVideoAutoplayAndLoopOff){video.pause();video.loop=false;}}).catch(function(err){console.warn('Could not autoplay replay video',err);video.muted=true;return video.play();}).catch(function(err){console.warn('Could play muted replay video after failed autoplay',err);});});_defineProperty(_assertThisInitialized(_this),\"handleDataAvailable\",function(event){if(_this.isDataHealthOK(event)){_this.recordedBlobs.push(event.data);}});_defineProperty(_assertThisInitialized(_this),\"handleStopRecording\",function(){if(_this.props.onStopRecording){_this.props.onStopRecording();}if(!_this.mediaRecorder){_this.handleError(new _customErrors.ReactVideoRecorderMediaRecorderUnavailableError());return;}_this.mediaRecorder.stop();});_defineProperty(_assertThisInitialized(_this),\"handlePauseRecording\",function(){if(_this.props.onPauseRecording){_this.props.onPauseRecording();}if(!_this.mediaRecorder){_this.handleError(new _customErrors.ReactVideoRecorderMediaRecorderUnavailableError());return;}_this.mediaRecorder.pause();});_defineProperty(_assertThisInitialized(_this),\"handleResumeRecording\",function(){if(_this.props.onResumeRecording){_this.props.onResumeRecording();}if(!_this.mediaRecorder){_this.handleError(new _customErrors.ReactVideoRecorderMediaRecorderUnavailableError());return;}_this.mediaRecorder.resume();});_defineProperty(_assertThisInitialized(_this),\"handleStartRecording\",function(){if(_this.props.onStartRecording){_this.props.onStartRecording();}_this.setState({isRunningCountdown:true,isReplayingVideo:false});setTimeout(function(){return _this.startRecording();},_this.props.countdownTime);});_defineProperty(_assertThisInitialized(_this),\"startRecording\",function(){(0,_getVideoInfo.captureThumb)(_this.cameraVideo).then(function(thumbnail){_this.thumbnail=thumbnail;_this.recordedBlobs=[];var options={mimeType:_this.getMimeType()};try{_this.setState({isRunningCountdown:false,isRecording:true});_this.startedAt=new Date().getTime();_this.mediaRecorder=new window.MediaRecorder(_this.stream,options);_this.mediaRecorder.addEventListener('stop',_this.handleStop);_this.mediaRecorder.addEventListener('error',_this.handleError);_this.mediaRecorder.addEventListener('dataavailable',_this.handleDataAvailable);var _this$props=_this.props,timeLimit=_this$props.timeLimit,chunkSize=_this$props.chunkSize,dataAvailableTimeout=_this$props.dataAvailableTimeout;_this.mediaRecorder.start(chunkSize);// collect 10ms of data\nif(timeLimit){_this.timeLimitTimeout=setTimeout(function(){_this.handleStopRecording();},timeLimit);}// mediaRecorder.ondataavailable should be called every 10ms,\n// as that's what we're passing to mediaRecorder.start() above\nif(Number.isInteger(dataAvailableTimeout)){setTimeout(function(){if(_this.recordedBlobs.length===0){_this.handleError(new _customErrors.ReactVideoRecorderDataAvailableTimeoutError(dataAvailableTimeout));}},dataAvailableTimeout);}}catch(err){console.error(\"Couldn't create MediaRecorder\",err,options);_this.handleError(err);}});});_defineProperty(_assertThisInitialized(_this),\"handleStop\",function(event){var endedAt=new Date().getTime();if(!_this.recordedBlobs||_this.recordedBlobs.length<=0){var error=new _customErrors.ReactVideoRecorderRecordedBlobsUnavailableError(event);console.error(error.message,event);_this.handleError(error);return;}clearTimeout(_this.timeLimitTimeout);var videoBlob=_this.recordedBlobs.length===1?_this.recordedBlobs[0]:new window.Blob(_this.recordedBlobs,{type:_this.getMimeType()});var thumbnailBlob=_this.thumbnail;var startedAt=_this.startedAt;var duration=endedAt-startedAt;// if this gets executed too soon, the last chunk of data is lost on FF\n_this.mediaRecorder.ondataavailable=null;_this.fixVideoMetadata(videoBlob).then(function(fixedVideoBlob){_this.setState({isRecording:false,isReplayingVideo:true,isReplayVideoMuted:true,fixedVideoBlob:fixedVideoBlob,videoUrl:window.URL.createObjectURL(fixedVideoBlob)});_this.turnOffCamera();_this.props.onRecordingComplete(fixedVideoBlob,startedAt,thumbnailBlob,duration);});});_defineProperty(_assertThisInitialized(_this),\"fixVideoMetadata\",function(rawVideoBlob){var _Blob$prototype,_Blob$prototype$array;// see https://stackoverflow.com/a/63568311\n(_Blob$prototype$array=(_Blob$prototype=Blob.prototype).arrayBuffer)!==null&&_Blob$prototype$array!==void 0?_Blob$prototype$array:_Blob$prototype.arrayBuffer=function(){return new Response(this).arrayBuffer();};return rawVideoBlob.arrayBuffer().then(function(buffer){var decoder=new _tsEbml.Decoder();var elements=decoder.decode(buffer);var reader=new _tsEbml.Reader();reader.logging=false;reader.drop_default_duration=false;elements.forEach(function(element){return reader.read(element);});reader.stop();var seekableMetadata=_tsEbml.tools.makeMetadataSeekable(reader.metadatas,reader.duration,reader.cues);var blobBody=buffer.slice(reader.metadataSize);var result=new Blob([seekableMetadata,blobBody],{type:rawVideoBlob.type});return result;});});_defineProperty(_assertThisInitialized(_this),\"handleVideoSelected\",function(e){if(_this.state.isReplayingVideo){_this.setState({isReplayingVideo:false});}var files=e.target.files||e.dataTransfer.files;if(files.length===0)return;var startedAt=new Date().getTime();var video=files[0];e.target.value=null;var extension=video.type==='video/quicktime'?'mov':undefined;(0,_getVideoInfo.default)(video).then(function(_ref){var duration=_ref.duration,thumbnail=_ref.thumbnail;_this.setState({isRecording:false,isReplayingVideo:true,isReplayVideoMuted:true,videoBlob:video,videoUrl:window.URL.createObjectURL(video)});_this.props.onRecordingComplete(video,startedAt,thumbnail,duration,extension);}).catch(function(err){_this.handleError(err);});});_defineProperty(_assertThisInitialized(_this),\"handleOpenVideoInput\",function(){if(_this.props.onOpenVideoInput){_this.props.onOpenVideoInput();}_this.videoInput.current.value=null;_this.videoInput.current.click();// fixes a bug on iPhone where it doesn't save the recorded video on the second time (if you press the 'Use another video' button)\n_this.videoInput.current.addEventListener('change',_this.handleVideoSelected);});_defineProperty(_assertThisInitialized(_this),\"handleStopReplaying\",function(){if(_this.props.onStopReplaying){_this.props.onStopReplaying();}if(_this.props.useVideoInput&&_this.props.isOnInitially){return _this.handleOpenVideoInput();}_this.setState({isReplayingVideo:false});if(_this.state.isInlineRecordingSupported&&_this.props.isOnInitially){_this.turnOnCamera();}else if(_this.state.isVideoInputSupported&&_this.props.isOnInitially){_this.handleOpenVideoInput();}});_defineProperty(_assertThisInitialized(_this),\"handleReplayVideoClick\",function(){if(_this.replayVideo.paused&&!_this.props.showReplayControls){_this.replayVideo.play();}// fixes bug where seeking control during autoplay is not available until the video is almost completely played through\nif(!_this.props.replayVideoAutoplayAndLoopOff){_this.setState({isReplayVideoMuted:!_this.state.isReplayVideoMuted});}});return _this;}_createClass(VideoRecorder,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var isInlineRecordingSupported=!!window.MediaSource&&!!window.MediaRecorder&&!!navigator.mediaDevices;var isVideoInputSupported=document.createElement('input').capture!==undefined;if(isInlineRecordingSupported){this.mediaSource=new window.MediaSource();}this.setState({isInlineRecordingSupported:isInlineRecordingSupported,isVideoInputSupported:isVideoInputSupported},function(){if(_this2.props.useVideoInput&&_this2.props.isOnInitially){_this2.handleOpenVideoInput();}else if(_this2.state.isInlineRecordingSupported&&_this2.props.isOnInitially){_this2.turnOnCamera();}else if(_this2.state.isVideoInputSupported&&_this2.props.isOnInitially){_this2.handleOpenVideoInput();}});}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps,prevState){if(this.replayVideo&&this.state.isReplayingVideo&&!prevState.isReplayingVideo){this.tryToUnmuteReplayVideo();}}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){this.turnOffCamera();}},{key:\"renderCameraView\",value:function renderCameraView(){var _this3=this;var _this$props2=this.props,showReplayControls=_this$props2.showReplayControls,replayVideoAutoplayAndLoopOff=_this$props2.replayVideoAutoplayAndLoopOff,renderDisconnectedView=_this$props2.renderDisconnectedView,renderVideoInputView=_this$props2.renderVideoInputView,renderUnsupportedView=_this$props2.renderUnsupportedView,renderErrorView=_this$props2.renderErrorView,renderLoadingView=_this$props2.renderLoadingView,useVideoInput=_this$props2.useVideoInput;var _this$state=this.state,isVideoInputSupported=_this$state.isVideoInputSupported,isReplayingVideo=_this$state.isReplayingVideo,isInlineRecordingSupported=_this$state.isInlineRecordingSupported,thereWasAnError=_this$state.thereWasAnError,error=_this$state.error,isCameraOn=_this$state.isCameraOn,isConnecting=_this$state.isConnecting,isReplayVideoMuted=_this$state.isReplayVideoMuted;var shouldUseVideoInput=useVideoInput||!isInlineRecordingSupported&&isVideoInputSupported;var videoInput=shouldUseVideoInput?/*#__PURE__*/_react.default.createElement(\"input\",{ref:this.videoInput,key:\"videoInput\",type:\"file\",accept:\"video/*\",capture:useVideoInput?undefined:'user',style:{display:'none'},onChange:this.handleVideoSelected}):null;if(isReplayingVideo){return/*#__PURE__*/_react.default.createElement(CameraView,{key:\"replay\"},/*#__PURE__*/_react.default.createElement(Video,{ref:function ref(el){return _this3.replayVideo=el;},src:this.state.videoUrl,loop:true,muted:isReplayVideoMuted,playsInline:true,autoPlay:!replayVideoAutoplayAndLoopOff,controls:showReplayControls,onClick:this.handleReplayVideoClick,onDurationChange:this.handleDurationChange}),videoInput);}if(shouldUseVideoInput){return renderVideoInputView({videoInput:videoInput});}if(!isInlineRecordingSupported){return renderUnsupportedView();}if(thereWasAnError){return renderErrorView({error:error});}if(isCameraOn){return/*#__PURE__*/_react.default.createElement(CameraView,{key:\"camera\"},/*#__PURE__*/_react.default.createElement(Video,{isFlipped:this.props.isFlipped,ref:function ref(el){return _this3.cameraVideo=el;},autoPlay:true,muted:true}));}if(isConnecting){return renderLoadingView();}return renderDisconnectedView();}},{key:\"render\",value:function render(){var _this$state2=this.state,isVideoInputSupported=_this$state2.isVideoInputSupported,isInlineRecordingSupported=_this$state2.isInlineRecordingSupported,thereWasAnError=_this$state2.thereWasAnError,isRecording=_this$state2.isRecording,isCameraOn=_this$state2.isCameraOn,streamIsReady=_this$state2.streamIsReady,isConnecting=_this$state2.isConnecting,isRunningCountdown=_this$state2.isRunningCountdown,isReplayingVideo=_this$state2.isReplayingVideo,isReplayVideoMuted=_this$state2.isReplayVideoMuted;var _this$props3=this.props,countdownTime=_this$props3.countdownTime,timeLimit=_this$props3.timeLimit,showReplayControls=_this$props3.showReplayControls,replayVideoAutoplayAndLoopOff=_this$props3.replayVideoAutoplayAndLoopOff,renderActions=_this$props3.renderActions,useVideoInput=_this$props3.useVideoInput;return/*#__PURE__*/_react.default.createElement(Wrapper,null,this.renderCameraView(),renderActions({isVideoInputSupported:isVideoInputSupported,isInlineRecordingSupported:isInlineRecordingSupported,thereWasAnError:thereWasAnError,isRecording:isRecording,isCameraOn:isCameraOn,streamIsReady:streamIsReady,isConnecting:isConnecting,isRunningCountdown:isRunningCountdown,isReplayingVideo:isReplayingVideo,isReplayVideoMuted:isReplayVideoMuted,countdownTime:countdownTime,timeLimit:timeLimit,showReplayControls:showReplayControls,replayVideoAutoplayAndLoopOff:replayVideoAutoplayAndLoopOff,useVideoInput:useVideoInput,onTurnOnCamera:this.turnOnCamera,onTurnOffCamera:this.turnOffCamera,onOpenVideoInput:this.handleOpenVideoInput,onStartRecording:this.handleStartRecording,onStopRecording:this.handleStopRecording,onPauseRecording:this.handlePauseRecording,onResumeRecording:this.handleResumeRecording,onStopReplaying:this.handleStopReplaying}));}}]);return VideoRecorder;}(_react.Component);exports.default=VideoRecorder;_defineProperty(VideoRecorder,\"propTypes\",{/** Whether or not to start the camera initially */isOnInitially:_propTypes.default.bool,/** Whether or not to display the video flipped (makes sense for user facing camera) */isFlipped:_propTypes.default.bool,/** Pass this if you want to force a specific mime-type for the video */mimeType:_propTypes.default.string,/** How much time to wait until it starts recording (in ms) */countdownTime:_propTypes.default.number,/** Use this if you want to set a time limit for the video (in ms) */timeLimit:_propTypes.default.number,/** Use this if you want to show play/pause/etc. controls on the replay video */showReplayControls:_propTypes.default.bool,/** Use this to turn off autoplay and looping of the replay video. It is recommended to also showReplayControls in order to play */replayVideoAutoplayAndLoopOff:_propTypes.default.bool,/** Use this if you want to customize the constraints passed to getUserMedia() */constraints:_propTypes.default.shape({audio:_propTypes.default.any,video:_propTypes.default.any}),chunkSize:_propTypes.default.number,dataAvailableTimeout:_propTypes.default.number,useVideoInput:_propTypes.default.bool,renderDisconnectedView:_propTypes.default.func,renderLoadingView:_propTypes.default.func,renderVideoInputView:_propTypes.default.func,renderUnsupportedView:_propTypes.default.func,renderErrorView:_propTypes.default.func,renderActions:_propTypes.default.func,onCameraOn:_propTypes.default.func,onTurnOnCamera:_propTypes.default.func,onTurnOffCamera:_propTypes.default.func,onStartRecording:_propTypes.default.func,onStopRecording:_propTypes.default.func,onPauseRecording:_propTypes.default.func,onResumeRecording:_propTypes.default.func,onRecordingComplete:_propTypes.default.func,onOpenVideoInput:_propTypes.default.func,onStopReplaying:_propTypes.default.func,onError:_propTypes.default.func});_defineProperty(VideoRecorder,\"defaultProps\",{renderUnsupportedView:function renderUnsupportedView(){return/*#__PURE__*/_react.default.createElement(_unsupportedView.default,null);},renderErrorView:function renderErrorView(){return/*#__PURE__*/_react.default.createElement(_errorView.default,null);},renderVideoInputView:function renderVideoInputView(_ref2){var videoInput=_ref2.videoInput;return/*#__PURE__*/_react.default.createElement(_react.default.Fragment,null,videoInput);},renderDisconnectedView:function renderDisconnectedView(){return/*#__PURE__*/_react.default.createElement(_disconnectedView.default,null);},renderLoadingView:function renderLoadingView(){return/*#__PURE__*/_react.default.createElement(_loadingView.default,null);},renderActions:_renderActions.default,isFlipped:true,countdownTime:3000,constraints:CONSTRAINTS,chunkSize:250,dataAvailableTimeout:500});","map":{"version":3,"sources":["/Users/randyadams/IMMORTIFYV2/immortify-app-client/src/react-video-recorder-master/lib/video-recorder.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","Object","defineProperty","exports","value","default","_react","_interopRequireWildcard","require","_propTypes","_interopRequireDefault","_styledComponents","_tsEbml","_unsupportedView","_errorView","_disconnectedView","_loadingView","_renderActions","_getVideoInfo","_customErrors","__esModule","_getRequireWildcardCache","WeakMap","cache","has","get","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","key","hasOwnProperty","call","desc","set","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","_createClass","protoProps","staticProps","_inherits","subClass","superClass","create","_setPrototypeOf","o","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","_getPrototypeOf","result","NewTarget","Reflect","construct","arguments","apply","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","sham","Proxy","Date","toString","e","getPrototypeOf","_defineProperty","MIME_TYPES","CONSTRAINTS","audio","video","Wrapper","div","withConfig","displayName","componentId","CameraView","Video","isFlipped","css","onClick","VideoRecorder","_Component","_super","_this","_len","args","Array","_key","concat","createRef","isRecording","isCameraOn","isConnecting","isReplayingVideo","isReplayVideoMuted","thereWasAnError","error","streamIsReady","isInlineRecordingSupported","isVideoInputSupported","stream","undefined","onTurnOnCamera","setState","fallbackContraints","navigator","mediaDevices","getUserMedia","constraints","catch","err","name","console","warn","then","handleSuccess","handleError","onTurnOffCamera","getTracks","forEach","stop","clearInterval","inactivityTimer","onCameraOn","window","URL","cameraVideo","srcObject","src","setTimeout","onError","clearTimeout","timeLimitTimeout","state","turnOffCamera","event","ReactVideoRecorderDataIssueError","message","mimeType","MediaRecorder","isTypeSupported","find","data","handleDataIssue","chunkSize","dataCheckInterval","blobCount","recordedBlobs","blob","Blob","type","getMimeType","size","replayVideo","muted","playPromise","play","replayVideoAutoplayAndLoopOff","pause","loop","isDataHealthOK","push","onStopRecording","mediaRecorder","ReactVideoRecorderMediaRecorderUnavailableError","onPauseRecording","onResumeRecording","resume","onStartRecording","isRunningCountdown","startRecording","countdownTime","captureThumb","thumbnail","options","startedAt","getTime","addEventListener","handleStop","handleDataAvailable","_this$props","timeLimit","dataAvailableTimeout","start","handleStopRecording","Number","isInteger","ReactVideoRecorderDataAvailableTimeoutError","endedAt","ReactVideoRecorderRecordedBlobsUnavailableError","videoBlob","thumbnailBlob","duration","ondataavailable","fixVideoMetadata","fixedVideoBlob","videoUrl","createObjectURL","onRecordingComplete","rawVideoBlob","_Blob$prototype","_Blob$prototype$array","arrayBuffer","Response","buffer","decoder","Decoder","elements","decode","reader","Reader","logging","drop_default_duration","element","read","seekableMetadata","tools","makeMetadataSeekable","metadatas","cues","blobBody","slice","metadataSize","files","dataTransfer","extension","_ref","onOpenVideoInput","videoInput","current","click","handleVideoSelected","onStopReplaying","useVideoInput","isOnInitially","handleOpenVideoInput","turnOnCamera","paused","showReplayControls","componentDidMount","_this2","MediaSource","document","createElement","capture","mediaSource","componentDidUpdate","prevProps","prevState","tryToUnmuteReplayVideo","componentWillUnmount","renderCameraView","_this3","_this$props2","renderDisconnectedView","renderVideoInputView","renderUnsupportedView","renderErrorView","renderLoadingView","_this$state","shouldUseVideoInput","ref","accept","style","display","onChange","el","playsInline","autoPlay","controls","handleReplayVideoClick","onDurationChange","handleDurationChange","render","_this$state2","_this$props3","renderActions","handleStartRecording","handlePauseRecording","handleResumeRecording","handleStopReplaying","Component","bool","string","number","shape","any","func","_ref2","Fragment"],"mappings":"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","sourcesContent":["\"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _styledComponents = _interopRequireWildcard(require(\"styled-components\"));\n\nvar _tsEbml = require(\"ts-ebml\");\n\nvar _unsupportedView = _interopRequireDefault(require(\"./defaults/unsupported-view\"));\n\nvar _errorView = _interopRequireDefault(require(\"./defaults/error-view\"));\n\nvar _disconnectedView = _interopRequireDefault(require(\"./defaults/disconnected-view\"));\n\nvar _loadingView = _interopRequireDefault(require(\"./defaults/loading-view\"));\n\nvar _renderActions = _interopRequireDefault(require(\"./defaults/render-actions\"));\n\nvar _getVideoInfo = _interopRequireWildcard(require(\"./get-video-info\"));\n\nvar _customErrors = require(\"./custom-errors\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _getRequireWildcardCache() { if (typeof WeakMap !== \"function\") return null; var cache = new WeakMap(); _getRequireWildcardCache = function _getRequireWildcardCache() { return cache; }; return cache; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar MIME_TYPES = ['video/webm;codecs=\"vp8,opus\"', 'video/webm;codecs=h264', 'video/webm;codecs=vp9', 'video/webm'];\nvar CONSTRAINTS = {\n  audio: true,\n  video: true\n};\n\nvar Wrapper = _styledComponents.default.div.withConfig({\n  displayName: \"video-recorder__Wrapper\",\n  componentId: \"sc-7k20rv-0\"\n})([\"position:relative;display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;height:100%;overflow:hidden;min-height:300px;background-color:#000;color:white;box-sizing:border-box;*{box-sizing:inherit;}\"]);\n\nvar CameraView = _styledComponents.default.div.withConfig({\n  displayName: \"video-recorder__CameraView\",\n  componentId: \"sc-7k20rv-1\"\n})([\"width:100%;height:100%;\"]);\n\nvar Video = _styledComponents.default.video.withConfig({\n  displayName: \"video-recorder__Video\",\n  componentId: \"sc-7k20rv-2\"\n})([\"position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);min-height:100%;min-width:100%;width:100%;height:100%;object-fit:cover;\", \";\", \";\"], function (props) {\n  return props.isFlipped && (0, _styledComponents.css)([\"transform:translate(-50%,-50%) scaleX(-1);\"]);\n}, function (props) {\n  return props.onClick && (0, _styledComponents.css)([\"cursor:pointer;\"]);\n});\n\nvar VideoRecorder = /*#__PURE__*/function (_Component) {\n  _inherits(VideoRecorder, _Component);\n\n  var _super = _createSuper(VideoRecorder);\n\n  function VideoRecorder() {\n    var _this;\n\n    _classCallCheck(this, VideoRecorder);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _defineProperty(_assertThisInitialized(_this), \"videoInput\", /*#__PURE__*/_react.default.createRef());\n\n    _defineProperty(_assertThisInitialized(_this), \"timeSinceInactivity\", 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      isRecording: false,\n      isCameraOn: false,\n      isConnecting: false,\n      isReplayingVideo: false,\n      isReplayVideoMuted: true,\n      thereWasAnError: false,\n      error: null,\n      streamIsReady: false,\n      isInlineRecordingSupported: null,\n      isVideoInputSupported: null,\n      stream: undefined\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"turnOnCamera\", function () {\n      if (_this.props.onTurnOnCamera) {\n        _this.props.onTurnOnCamera();\n      }\n\n      _this.setState({\n        isConnecting: true,\n        isReplayingVideo: false,\n        thereWasAnError: false,\n        error: null\n      });\n\n      var fallbackContraints = {\n        audio: true,\n        video: true\n      };\n      navigator.mediaDevices.getUserMedia(_this.props.constraints).catch(function (err) {\n        // there's a bug in chrome in some windows computers where using `ideal` in the constraints throws a NotReadableError\n        if (err.name === 'NotReadableError' || err.name === 'OverconstrainedError') {\n          console.warn(\"Got \".concat(err.name, \", trying getUserMedia again with fallback constraints\"));\n          return navigator.mediaDevices.getUserMedia(fallbackContraints);\n        }\n\n        throw err;\n      }).then(_this.handleSuccess).catch(_this.handleError);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"turnOffCamera\", function () {\n      if (_this.props.onTurnOffCamera) {\n        _this.props.onTurnOffCamera();\n      }\n\n      _this.stream && _this.stream.getTracks().forEach(function (stream) {\n        return stream.stop();\n      });\n\n      _this.setState({\n        isCameraOn: false\n      });\n\n      clearInterval(_this.inactivityTimer);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleSuccess\", function (stream) {\n      _this.stream = stream;\n\n      _this.setState({\n        isCameraOn: true,\n        stream: stream\n      });\n\n      if (_this.props.onCameraOn) {\n        _this.props.onCameraOn();\n      }\n\n      if (window.URL) {\n        _this.cameraVideo.srcObject = stream;\n      } else {\n        _this.cameraVideo.src = stream;\n      } // there is probably a better way\n      // but this makes sure the start recording button\n      // gives the stream a couple miliseconds to be ready\n\n\n      setTimeout(function () {\n        _this.setState({\n          isConnecting: false,\n          streamIsReady: true\n        });\n      }, 200);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleError\", function (err) {\n      var onError = _this.props.onError;\n      console.error('Captured error', err);\n      clearTimeout(_this.timeLimitTimeout);\n\n      if (onError) {\n        onError(err);\n      }\n\n      _this.setState({\n        isConnecting: _this.state.isConnecting && false,\n        isRecording: false,\n        thereWasAnError: true,\n        error: err\n      });\n\n      if (_this.state.isCameraOn) {\n        _this.turnOffCamera();\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleDataIssue\", function (event) {\n      var error = new _customErrors.ReactVideoRecorderDataIssueError(event);\n      console.error(error.message, event);\n\n      _this.handleError(error);\n\n      return false;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getMimeType\", function () {\n      if (_this.props.mimeType) {\n        return _this.props.mimeType;\n      }\n\n      var mimeType = window.MediaRecorder.isTypeSupported ? MIME_TYPES.find(window.MediaRecorder.isTypeSupported) : 'video/webm';\n      return mimeType || '';\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"isDataHealthOK\", function (event) {\n      if (!event.data) return _this.handleDataIssue(event);\n      var chunkSize = _this.props.chunkSize;\n      var dataCheckInterval = 2000 / chunkSize; // in some browsers (FF/S), data only shows up\n      // after a certain amount of time ~everyt 2 seconds\n\n      var blobCount = _this.recordedBlobs.length;\n\n      if (blobCount > dataCheckInterval && blobCount % dataCheckInterval === 0) {\n        var blob = new window.Blob(_this.recordedBlobs, {\n          type: _this.getMimeType()\n        });\n        if (blob.size <= 0) return _this.handleDataIssue(event);\n      }\n\n      return true;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"tryToUnmuteReplayVideo\", function () {\n      var video = _this.replayVideo;\n      video.muted = false;\n      var playPromise = video.play();\n\n      if (!playPromise) {\n        video.muted = true;\n        return;\n      }\n\n      playPromise.then(function () {\n        _this.setState({\n          isReplayVideoMuted: false\n        }); // fixes bug where seeking control during autoplay is not available until the video is almost completely played through\n\n\n        if (_this.props.replayVideoAutoplayAndLoopOff) {\n          video.pause();\n          video.loop = false;\n        }\n      }).catch(function (err) {\n        console.warn('Could not autoplay replay video', err);\n        video.muted = true;\n        return video.play();\n      }).catch(function (err) {\n        console.warn('Could play muted replay video after failed autoplay', err);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleDataAvailable\", function (event) {\n      if (_this.isDataHealthOK(event)) {\n        _this.recordedBlobs.push(event.data);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleStopRecording\", function () {\n      if (_this.props.onStopRecording) {\n        _this.props.onStopRecording();\n      }\n\n      if (!_this.mediaRecorder) {\n        _this.handleError(new _customErrors.ReactVideoRecorderMediaRecorderUnavailableError());\n\n        return;\n      }\n\n      _this.mediaRecorder.stop();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handlePauseRecording\", function () {\n      if (_this.props.onPauseRecording) {\n        _this.props.onPauseRecording();\n      }\n\n      if (!_this.mediaRecorder) {\n        _this.handleError(new _customErrors.ReactVideoRecorderMediaRecorderUnavailableError());\n\n        return;\n      }\n\n      _this.mediaRecorder.pause();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleResumeRecording\", function () {\n      if (_this.props.onResumeRecording) {\n        _this.props.onResumeRecording();\n      }\n\n      if (!_this.mediaRecorder) {\n        _this.handleError(new _customErrors.ReactVideoRecorderMediaRecorderUnavailableError());\n\n        return;\n      }\n\n      _this.mediaRecorder.resume();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleStartRecording\", function () {\n      if (_this.props.onStartRecording) {\n        _this.props.onStartRecording();\n      }\n\n      _this.setState({\n        isRunningCountdown: true,\n        isReplayingVideo: false\n      });\n\n      setTimeout(function () {\n        return _this.startRecording();\n      }, _this.props.countdownTime);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"startRecording\", function () {\n      (0, _getVideoInfo.captureThumb)(_this.cameraVideo).then(function (thumbnail) {\n        _this.thumbnail = thumbnail;\n        _this.recordedBlobs = [];\n        var options = {\n          mimeType: _this.getMimeType()\n        };\n\n        try {\n          _this.setState({\n            isRunningCountdown: false,\n            isRecording: true\n          });\n\n          _this.startedAt = new Date().getTime();\n          _this.mediaRecorder = new window.MediaRecorder(_this.stream, options);\n\n          _this.mediaRecorder.addEventListener('stop', _this.handleStop);\n\n          _this.mediaRecorder.addEventListener('error', _this.handleError);\n\n          _this.mediaRecorder.addEventListener('dataavailable', _this.handleDataAvailable);\n\n          var _this$props = _this.props,\n              timeLimit = _this$props.timeLimit,\n              chunkSize = _this$props.chunkSize,\n              dataAvailableTimeout = _this$props.dataAvailableTimeout;\n\n          _this.mediaRecorder.start(chunkSize); // collect 10ms of data\n\n\n          if (timeLimit) {\n            _this.timeLimitTimeout = setTimeout(function () {\n              _this.handleStopRecording();\n            }, timeLimit);\n          } // mediaRecorder.ondataavailable should be called every 10ms,\n          // as that's what we're passing to mediaRecorder.start() above\n\n\n          if (Number.isInteger(dataAvailableTimeout)) {\n            setTimeout(function () {\n              if (_this.recordedBlobs.length === 0) {\n                _this.handleError(new _customErrors.ReactVideoRecorderDataAvailableTimeoutError(dataAvailableTimeout));\n              }\n            }, dataAvailableTimeout);\n          }\n        } catch (err) {\n          console.error(\"Couldn't create MediaRecorder\", err, options);\n\n          _this.handleError(err);\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleStop\", function (event) {\n      var endedAt = new Date().getTime();\n\n      if (!_this.recordedBlobs || _this.recordedBlobs.length <= 0) {\n        var error = new _customErrors.ReactVideoRecorderRecordedBlobsUnavailableError(event);\n        console.error(error.message, event);\n\n        _this.handleError(error);\n\n        return;\n      }\n\n      clearTimeout(_this.timeLimitTimeout);\n      var videoBlob = _this.recordedBlobs.length === 1 ? _this.recordedBlobs[0] : new window.Blob(_this.recordedBlobs, {\n        type: _this.getMimeType()\n      });\n      var thumbnailBlob = _this.thumbnail;\n      var startedAt = _this.startedAt;\n      var duration = endedAt - startedAt; // if this gets executed too soon, the last chunk of data is lost on FF\n\n      _this.mediaRecorder.ondataavailable = null;\n\n      _this.fixVideoMetadata(videoBlob).then(function (fixedVideoBlob) {\n        _this.setState({\n          isRecording: false,\n          isReplayingVideo: true,\n          isReplayVideoMuted: true,\n          fixedVideoBlob: fixedVideoBlob,\n          videoUrl: window.URL.createObjectURL(fixedVideoBlob)\n        });\n\n        _this.turnOffCamera();\n\n        _this.props.onRecordingComplete(fixedVideoBlob, startedAt, thumbnailBlob, duration);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"fixVideoMetadata\", function (rawVideoBlob) {\n      var _Blob$prototype, _Blob$prototype$array;\n\n      // see https://stackoverflow.com/a/63568311\n      (_Blob$prototype$array = (_Blob$prototype = Blob.prototype).arrayBuffer) !== null && _Blob$prototype$array !== void 0 ? _Blob$prototype$array : _Blob$prototype.arrayBuffer = function () {\n        return new Response(this).arrayBuffer();\n      };\n      return rawVideoBlob.arrayBuffer().then(function (buffer) {\n        var decoder = new _tsEbml.Decoder();\n        var elements = decoder.decode(buffer);\n        var reader = new _tsEbml.Reader();\n        reader.logging = false;\n        reader.drop_default_duration = false;\n        elements.forEach(function (element) {\n          return reader.read(element);\n        });\n        reader.stop();\n\n        var seekableMetadata = _tsEbml.tools.makeMetadataSeekable(reader.metadatas, reader.duration, reader.cues);\n\n        var blobBody = buffer.slice(reader.metadataSize);\n        var result = new Blob([seekableMetadata, blobBody], {\n          type: rawVideoBlob.type\n        });\n        return result;\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleVideoSelected\", function (e) {\n      if (_this.state.isReplayingVideo) {\n        _this.setState({\n          isReplayingVideo: false\n        });\n      }\n\n      var files = e.target.files || e.dataTransfer.files;\n      if (files.length === 0) return;\n      var startedAt = new Date().getTime();\n      var video = files[0];\n      e.target.value = null;\n      var extension = video.type === 'video/quicktime' ? 'mov' : undefined;\n      (0, _getVideoInfo.default)(video).then(function (_ref) {\n        var duration = _ref.duration,\n            thumbnail = _ref.thumbnail;\n\n        _this.setState({\n          isRecording: false,\n          isReplayingVideo: true,\n          isReplayVideoMuted: true,\n          videoBlob: video,\n          videoUrl: window.URL.createObjectURL(video)\n        });\n\n        _this.props.onRecordingComplete(video, startedAt, thumbnail, duration, extension);\n      }).catch(function (err) {\n        _this.handleError(err);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleOpenVideoInput\", function () {\n      if (_this.props.onOpenVideoInput) {\n        _this.props.onOpenVideoInput();\n      }\n\n      _this.videoInput.current.value = null;\n\n      _this.videoInput.current.click(); // fixes a bug on iPhone where it doesn't save the recorded video on the second time (if you press the 'Use another video' button)\n\n\n      _this.videoInput.current.addEventListener('change', _this.handleVideoSelected);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleStopReplaying\", function () {\n      if (_this.props.onStopReplaying) {\n        _this.props.onStopReplaying();\n      }\n\n      if (_this.props.useVideoInput && _this.props.isOnInitially) {\n        return _this.handleOpenVideoInput();\n      }\n\n      _this.setState({\n        isReplayingVideo: false\n      });\n\n      if (_this.state.isInlineRecordingSupported && _this.props.isOnInitially) {\n        _this.turnOnCamera();\n      } else if (_this.state.isVideoInputSupported && _this.props.isOnInitially) {\n        _this.handleOpenVideoInput();\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleReplayVideoClick\", function () {\n      if (_this.replayVideo.paused && !_this.props.showReplayControls) {\n        _this.replayVideo.play();\n      } // fixes bug where seeking control during autoplay is not available until the video is almost completely played through\n\n\n      if (!_this.props.replayVideoAutoplayAndLoopOff) {\n        _this.setState({\n          isReplayVideoMuted: !_this.state.isReplayVideoMuted\n        });\n      }\n    });\n\n    return _this;\n  }\n\n  _createClass(VideoRecorder, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var isInlineRecordingSupported = !!window.MediaSource && !!window.MediaRecorder && !!navigator.mediaDevices;\n      var isVideoInputSupported = document.createElement('input').capture !== undefined;\n\n      if (isInlineRecordingSupported) {\n        this.mediaSource = new window.MediaSource();\n      }\n\n      this.setState({\n        isInlineRecordingSupported: isInlineRecordingSupported,\n        isVideoInputSupported: isVideoInputSupported\n      }, function () {\n        if (_this2.props.useVideoInput && _this2.props.isOnInitially) {\n          _this2.handleOpenVideoInput();\n        } else if (_this2.state.isInlineRecordingSupported && _this2.props.isOnInitially) {\n          _this2.turnOnCamera();\n        } else if (_this2.state.isVideoInputSupported && _this2.props.isOnInitially) {\n          _this2.handleOpenVideoInput();\n        }\n      });\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      if (this.replayVideo && this.state.isReplayingVideo && !prevState.isReplayingVideo) {\n        this.tryToUnmuteReplayVideo();\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.turnOffCamera();\n    }\n  }, {\n    key: \"renderCameraView\",\n    value: function renderCameraView() {\n      var _this3 = this;\n\n      var _this$props2 = this.props,\n          showReplayControls = _this$props2.showReplayControls,\n          replayVideoAutoplayAndLoopOff = _this$props2.replayVideoAutoplayAndLoopOff,\n          renderDisconnectedView = _this$props2.renderDisconnectedView,\n          renderVideoInputView = _this$props2.renderVideoInputView,\n          renderUnsupportedView = _this$props2.renderUnsupportedView,\n          renderErrorView = _this$props2.renderErrorView,\n          renderLoadingView = _this$props2.renderLoadingView,\n          useVideoInput = _this$props2.useVideoInput;\n      var _this$state = this.state,\n          isVideoInputSupported = _this$state.isVideoInputSupported,\n          isReplayingVideo = _this$state.isReplayingVideo,\n          isInlineRecordingSupported = _this$state.isInlineRecordingSupported,\n          thereWasAnError = _this$state.thereWasAnError,\n          error = _this$state.error,\n          isCameraOn = _this$state.isCameraOn,\n          isConnecting = _this$state.isConnecting,\n          isReplayVideoMuted = _this$state.isReplayVideoMuted;\n      var shouldUseVideoInput = useVideoInput || !isInlineRecordingSupported && isVideoInputSupported;\n      var videoInput = shouldUseVideoInput ? /*#__PURE__*/_react.default.createElement(\"input\", {\n        ref: this.videoInput,\n        key: \"videoInput\",\n        type: \"file\",\n        accept: \"video/*\",\n        capture: useVideoInput ? undefined : 'user',\n        style: {\n          display: 'none'\n        },\n        onChange: this.handleVideoSelected\n      }) : null;\n\n      if (isReplayingVideo) {\n        return /*#__PURE__*/_react.default.createElement(CameraView, {\n          key: \"replay\"\n        }, /*#__PURE__*/_react.default.createElement(Video, {\n          ref: function ref(el) {\n            return _this3.replayVideo = el;\n          },\n          src: this.state.videoUrl,\n          loop: true,\n          muted: isReplayVideoMuted,\n          playsInline: true,\n          autoPlay: !replayVideoAutoplayAndLoopOff,\n          controls: showReplayControls,\n          onClick: this.handleReplayVideoClick,\n          onDurationChange: this.handleDurationChange\n        }), videoInput);\n      }\n\n      if (shouldUseVideoInput) {\n        return renderVideoInputView({\n          videoInput: videoInput\n        });\n      }\n\n      if (!isInlineRecordingSupported) {\n        return renderUnsupportedView();\n      }\n\n      if (thereWasAnError) {\n        return renderErrorView({\n          error: error\n        });\n      }\n\n      if (isCameraOn) {\n        return /*#__PURE__*/_react.default.createElement(CameraView, {\n          key: \"camera\"\n        }, /*#__PURE__*/_react.default.createElement(Video, {\n          isFlipped: this.props.isFlipped,\n          ref: function ref(el) {\n            return _this3.cameraVideo = el;\n          },\n          autoPlay: true,\n          muted: true\n        }));\n      }\n\n      if (isConnecting) {\n        return renderLoadingView();\n      }\n\n      return renderDisconnectedView();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state2 = this.state,\n          isVideoInputSupported = _this$state2.isVideoInputSupported,\n          isInlineRecordingSupported = _this$state2.isInlineRecordingSupported,\n          thereWasAnError = _this$state2.thereWasAnError,\n          isRecording = _this$state2.isRecording,\n          isCameraOn = _this$state2.isCameraOn,\n          streamIsReady = _this$state2.streamIsReady,\n          isConnecting = _this$state2.isConnecting,\n          isRunningCountdown = _this$state2.isRunningCountdown,\n          isReplayingVideo = _this$state2.isReplayingVideo,\n          isReplayVideoMuted = _this$state2.isReplayVideoMuted;\n      var _this$props3 = this.props,\n          countdownTime = _this$props3.countdownTime,\n          timeLimit = _this$props3.timeLimit,\n          showReplayControls = _this$props3.showReplayControls,\n          replayVideoAutoplayAndLoopOff = _this$props3.replayVideoAutoplayAndLoopOff,\n          renderActions = _this$props3.renderActions,\n          useVideoInput = _this$props3.useVideoInput;\n      return /*#__PURE__*/_react.default.createElement(Wrapper, null, this.renderCameraView(), renderActions({\n        isVideoInputSupported: isVideoInputSupported,\n        isInlineRecordingSupported: isInlineRecordingSupported,\n        thereWasAnError: thereWasAnError,\n        isRecording: isRecording,\n        isCameraOn: isCameraOn,\n        streamIsReady: streamIsReady,\n        isConnecting: isConnecting,\n        isRunningCountdown: isRunningCountdown,\n        isReplayingVideo: isReplayingVideo,\n        isReplayVideoMuted: isReplayVideoMuted,\n        countdownTime: countdownTime,\n        timeLimit: timeLimit,\n        showReplayControls: showReplayControls,\n        replayVideoAutoplayAndLoopOff: replayVideoAutoplayAndLoopOff,\n        useVideoInput: useVideoInput,\n        onTurnOnCamera: this.turnOnCamera,\n        onTurnOffCamera: this.turnOffCamera,\n        onOpenVideoInput: this.handleOpenVideoInput,\n        onStartRecording: this.handleStartRecording,\n        onStopRecording: this.handleStopRecording,\n        onPauseRecording: this.handlePauseRecording,\n        onResumeRecording: this.handleResumeRecording,\n        onStopReplaying: this.handleStopReplaying\n      }));\n    }\n  }]);\n\n  return VideoRecorder;\n}(_react.Component);\n\nexports.default = VideoRecorder;\n\n_defineProperty(VideoRecorder, \"propTypes\", {\n  /** Whether or not to start the camera initially */\n  isOnInitially: _propTypes.default.bool,\n\n  /** Whether or not to display the video flipped (makes sense for user facing camera) */\n  isFlipped: _propTypes.default.bool,\n\n  /** Pass this if you want to force a specific mime-type for the video */\n  mimeType: _propTypes.default.string,\n\n  /** How much time to wait until it starts recording (in ms) */\n  countdownTime: _propTypes.default.number,\n\n  /** Use this if you want to set a time limit for the video (in ms) */\n  timeLimit: _propTypes.default.number,\n\n  /** Use this if you want to show play/pause/etc. controls on the replay video */\n  showReplayControls: _propTypes.default.bool,\n\n  /** Use this to turn off autoplay and looping of the replay video. It is recommended to also showReplayControls in order to play */\n  replayVideoAutoplayAndLoopOff: _propTypes.default.bool,\n\n  /** Use this if you want to customize the constraints passed to getUserMedia() */\n  constraints: _propTypes.default.shape({\n    audio: _propTypes.default.any,\n    video: _propTypes.default.any\n  }),\n  chunkSize: _propTypes.default.number,\n  dataAvailableTimeout: _propTypes.default.number,\n  useVideoInput: _propTypes.default.bool,\n  renderDisconnectedView: _propTypes.default.func,\n  renderLoadingView: _propTypes.default.func,\n  renderVideoInputView: _propTypes.default.func,\n  renderUnsupportedView: _propTypes.default.func,\n  renderErrorView: _propTypes.default.func,\n  renderActions: _propTypes.default.func,\n  onCameraOn: _propTypes.default.func,\n  onTurnOnCamera: _propTypes.default.func,\n  onTurnOffCamera: _propTypes.default.func,\n  onStartRecording: _propTypes.default.func,\n  onStopRecording: _propTypes.default.func,\n  onPauseRecording: _propTypes.default.func,\n  onResumeRecording: _propTypes.default.func,\n  onRecordingComplete: _propTypes.default.func,\n  onOpenVideoInput: _propTypes.default.func,\n  onStopReplaying: _propTypes.default.func,\n  onError: _propTypes.default.func\n});\n\n_defineProperty(VideoRecorder, \"defaultProps\", {\n  renderUnsupportedView: function renderUnsupportedView() {\n    return /*#__PURE__*/_react.default.createElement(_unsupportedView.default, null);\n  },\n  renderErrorView: function renderErrorView() {\n    return /*#__PURE__*/_react.default.createElement(_errorView.default, null);\n  },\n  renderVideoInputView: function renderVideoInputView(_ref2) {\n    var videoInput = _ref2.videoInput;\n    return /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, videoInput);\n  },\n  renderDisconnectedView: function renderDisconnectedView() {\n    return /*#__PURE__*/_react.default.createElement(_disconnectedView.default, null);\n  },\n  renderLoadingView: function renderLoadingView() {\n    return /*#__PURE__*/_react.default.createElement(_loadingView.default, null);\n  },\n  renderActions: _renderActions.default,\n  isFlipped: true,\n  countdownTime: 3000,\n  constraints: CONSTRAINTS,\n  chunkSize: 250,\n  dataAvailableTimeout: 500\n});"]},"metadata":{},"sourceType":"module"}