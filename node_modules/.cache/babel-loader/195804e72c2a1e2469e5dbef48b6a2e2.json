{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.captureThumb = void 0;\n\nvar captureThumb = function captureThumb(videoTag) {\n  return new Promise(function (resolve, reject) {\n    var canvas = document.createElement('canvas');\n    canvas.width = videoTag.videoWidth;\n    canvas.height = videoTag.videoHeight;\n    canvas.getContext('2d').drawImage(videoTag, 0, // top\n    0, // left\n    videoTag.videoWidth, videoTag.videoHeight);\n    canvas.toBlob(function (thumbnail) {\n      resolve(thumbnail);\n    }, 'image/jpeg');\n  });\n};\n\nexports.captureThumb = captureThumb;\n\nvar getVideoInfo = function getVideoInfo(videoBlob) {\n  return new Promise(function (resolve, reject) {\n    var videoTag = document.createElement('video');\n    videoTag.preload = 'metadata';\n    videoTag.muted = true;\n    videoTag.defaultMuted = true;\n    videoTag.playsInline = true;\n    videoTag.autoplay = true;\n    var resolved = false;\n\n    var handleTimeout = function handleTimeout() {\n      resolved = true;\n      resolve({\n        duration: null,\n        thumbnail: null\n      });\n      videoTag.removeEventListener && videoTag.removeEventListener('loadeddata', handleLoadedData);\n      window.URL.revokeObjectURL(videoTag.src);\n    };\n\n    var timeout = setTimeout(handleTimeout, 1000);\n\n    var handleVideoTag = function handleVideoTag(duration) {\n      captureThumb(videoTag).then(function (thumbnail) {\n        videoTag.pause();\n\n        if (!resolved) {\n          clearTimeout(timeout);\n          resolved = true;\n          resolve({\n            duration: duration,\n            thumbnail: thumbnail\n          });\n        }\n\n        window.URL.revokeObjectURL(videoTag.src);\n      }).catch(function (err) {\n        if (!resolved) {\n          clearTimeout(timeout);\n          resolved = true;\n          reject(err);\n        }\n      });\n    };\n\n    var handleLoadedData = function handleLoadedData() {\n      var duration = videoTag.duration * 1000;\n\n      if (videoTag.duration === Infinity) {\n        videoTag.currentTime = Number.MAX_SAFE_INTEGER;\n\n        videoTag.ontimeupdate = function () {\n          videoTag.ontimeupdate = null;\n          duration = videoTag.duration * 1000;\n          videoTag.currentTime = 0;\n          handleVideoTag(duration);\n        };\n      } else {\n        handleVideoTag(duration);\n      }\n    };\n\n    videoTag.addEventListener('loadeddata', handleLoadedData);\n    videoTag.src = window.URL.createObjectURL(videoBlob);\n  });\n};\n\nvar _default = getVideoInfo;\nexports.default = _default;","map":{"version":3,"sources":["/Users/randyadams/IMMORTIFYV2/immortify-app-client/src/react-video-recorder-master/lib/get-video-info.js"],"names":["Object","defineProperty","exports","value","default","captureThumb","videoTag","Promise","resolve","reject","canvas","document","createElement","width","videoWidth","height","videoHeight","getContext","drawImage","toBlob","thumbnail","getVideoInfo","videoBlob","preload","muted","defaultMuted","playsInline","autoplay","resolved","handleTimeout","duration","removeEventListener","handleLoadedData","window","URL","revokeObjectURL","src","timeout","setTimeout","handleVideoTag","then","pause","clearTimeout","catch","err","Infinity","currentTime","Number","MAX_SAFE_INTEGER","ontimeupdate","addEventListener","createObjectURL","_default"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.captureThumb = void 0;\n\nvar captureThumb = function captureThumb(videoTag) {\n  return new Promise(function (resolve, reject) {\n    var canvas = document.createElement('canvas');\n    canvas.width = videoTag.videoWidth;\n    canvas.height = videoTag.videoHeight;\n    canvas.getContext('2d').drawImage(videoTag, 0, // top\n    0, // left\n    videoTag.videoWidth, videoTag.videoHeight);\n    canvas.toBlob(function (thumbnail) {\n      resolve(thumbnail);\n    }, 'image/jpeg');\n  });\n};\n\nexports.captureThumb = captureThumb;\n\nvar getVideoInfo = function getVideoInfo(videoBlob) {\n  return new Promise(function (resolve, reject) {\n    var videoTag = document.createElement('video');\n    videoTag.preload = 'metadata';\n    videoTag.muted = true;\n    videoTag.defaultMuted = true;\n    videoTag.playsInline = true;\n    videoTag.autoplay = true;\n    var resolved = false;\n\n    var handleTimeout = function handleTimeout() {\n      resolved = true;\n      resolve({\n        duration: null,\n        thumbnail: null\n      });\n      videoTag.removeEventListener && videoTag.removeEventListener('loadeddata', handleLoadedData);\n      window.URL.revokeObjectURL(videoTag.src);\n    };\n\n    var timeout = setTimeout(handleTimeout, 1000);\n\n    var handleVideoTag = function handleVideoTag(duration) {\n      captureThumb(videoTag).then(function (thumbnail) {\n        videoTag.pause();\n\n        if (!resolved) {\n          clearTimeout(timeout);\n          resolved = true;\n          resolve({\n            duration: duration,\n            thumbnail: thumbnail\n          });\n        }\n\n        window.URL.revokeObjectURL(videoTag.src);\n      }).catch(function (err) {\n        if (!resolved) {\n          clearTimeout(timeout);\n          resolved = true;\n          reject(err);\n        }\n      });\n    };\n\n    var handleLoadedData = function handleLoadedData() {\n      var duration = videoTag.duration * 1000;\n\n      if (videoTag.duration === Infinity) {\n        videoTag.currentTime = Number.MAX_SAFE_INTEGER;\n\n        videoTag.ontimeupdate = function () {\n          videoTag.ontimeupdate = null;\n          duration = videoTag.duration * 1000;\n          videoTag.currentTime = 0;\n          handleVideoTag(duration);\n        };\n      } else {\n        handleVideoTag(duration);\n      }\n    };\n\n    videoTag.addEventListener('loadeddata', handleLoadedData);\n    videoTag.src = window.URL.createObjectURL(videoBlob);\n  });\n};\n\nvar _default = getVideoInfo;\nexports.default = _default;"]},"metadata":{},"sourceType":"module"}