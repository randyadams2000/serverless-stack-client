{"ast":null,"code":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=exports.captureThumb=void 0;var captureThumb=function captureThumb(videoTag){return new Promise(function(resolve,reject){var canvas=document.createElement('canvas');canvas.width=videoTag.videoWidth;canvas.height=videoTag.videoHeight;canvas.getContext('2d').drawImage(videoTag,0,// top\n0,// left\nvideoTag.videoWidth,videoTag.videoHeight);canvas.toBlob(function(thumbnail){resolve(thumbnail);},'image/jpeg');});};exports.captureThumb=captureThumb;var getVideoInfo=function getVideoInfo(videoBlob){return new Promise(function(resolve,reject){var videoTag=document.createElement('video');videoTag.preload='metadata';videoTag.muted=true;videoTag.defaultMuted=true;videoTag.playsInline=true;videoTag.autoplay=true;var resolved=false;var handleTimeout=function handleTimeout(){resolved=true;resolve({duration:null,thumbnail:null});videoTag.removeEventListener&&videoTag.removeEventListener('loadeddata',handleLoadedData);window.URL.revokeObjectURL(videoTag.src);};var timeout=setTimeout(handleTimeout,1000);var handleVideoTag=function handleVideoTag(duration){captureThumb(videoTag).then(function(thumbnail){videoTag.pause();if(!resolved){clearTimeout(timeout);resolved=true;resolve({duration:duration,thumbnail:thumbnail});}window.URL.revokeObjectURL(videoTag.src);}).catch(function(err){if(!resolved){clearTimeout(timeout);resolved=true;reject(err);}});};var handleLoadedData=function handleLoadedData(){var duration=videoTag.duration*1000;if(videoTag.duration===Infinity){videoTag.currentTime=Number.MAX_SAFE_INTEGER;videoTag.ontimeupdate=function(){videoTag.ontimeupdate=null;duration=videoTag.duration*1000;videoTag.currentTime=0;handleVideoTag(duration);};}else{handleVideoTag(duration);}};videoTag.addEventListener('loadeddata',handleLoadedData);videoTag.src=window.URL.createObjectURL(videoBlob);});};var _default=getVideoInfo;exports.default=_default;","map":{"version":3,"sources":["/Users/randyadams/IMMORTIFYV2/immortify-app-client/src/react-video-recorder-master/lib/get-video-info.js"],"names":["Object","defineProperty","exports","value","default","captureThumb","videoTag","Promise","resolve","reject","canvas","document","createElement","width","videoWidth","height","videoHeight","getContext","drawImage","toBlob","thumbnail","getVideoInfo","videoBlob","preload","muted","defaultMuted","playsInline","autoplay","resolved","handleTimeout","duration","removeEventListener","handleLoadedData","window","URL","revokeObjectURL","src","timeout","setTimeout","handleVideoTag","then","pause","clearTimeout","catch","err","Infinity","currentTime","Number","MAX_SAFE_INTEGER","ontimeupdate","addEventListener","createObjectURL","_default"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.captureThumb = void 0;\n\nvar captureThumb = function captureThumb(videoTag) {\n  return new Promise(function (resolve, reject) {\n    var canvas = document.createElement('canvas');\n    canvas.width = videoTag.videoWidth;\n    canvas.height = videoTag.videoHeight;\n    canvas.getContext('2d').drawImage(videoTag, 0, // top\n    0, // left\n    videoTag.videoWidth, videoTag.videoHeight);\n    canvas.toBlob(function (thumbnail) {\n      resolve(thumbnail);\n    }, 'image/jpeg');\n  });\n};\n\nexports.captureThumb = captureThumb;\n\nvar getVideoInfo = function getVideoInfo(videoBlob) {\n  return new Promise(function (resolve, reject) {\n    var videoTag = document.createElement('video');\n    videoTag.preload = 'metadata';\n    videoTag.muted = true;\n    videoTag.defaultMuted = true;\n    videoTag.playsInline = true;\n    videoTag.autoplay = true;\n    var resolved = false;\n\n    var handleTimeout = function handleTimeout() {\n      resolved = true;\n      resolve({\n        duration: null,\n        thumbnail: null\n      });\n      videoTag.removeEventListener && videoTag.removeEventListener('loadeddata', handleLoadedData);\n      window.URL.revokeObjectURL(videoTag.src);\n    };\n\n    var timeout = setTimeout(handleTimeout, 1000);\n\n    var handleVideoTag = function handleVideoTag(duration) {\n      captureThumb(videoTag).then(function (thumbnail) {\n        videoTag.pause();\n\n        if (!resolved) {\n          clearTimeout(timeout);\n          resolved = true;\n          resolve({\n            duration: duration,\n            thumbnail: thumbnail\n          });\n        }\n\n        window.URL.revokeObjectURL(videoTag.src);\n      }).catch(function (err) {\n        if (!resolved) {\n          clearTimeout(timeout);\n          resolved = true;\n          reject(err);\n        }\n      });\n    };\n\n    var handleLoadedData = function handleLoadedData() {\n      var duration = videoTag.duration * 1000;\n\n      if (videoTag.duration === Infinity) {\n        videoTag.currentTime = Number.MAX_SAFE_INTEGER;\n\n        videoTag.ontimeupdate = function () {\n          videoTag.ontimeupdate = null;\n          duration = videoTag.duration * 1000;\n          videoTag.currentTime = 0;\n          handleVideoTag(duration);\n        };\n      } else {\n        handleVideoTag(duration);\n      }\n    };\n\n    videoTag.addEventListener('loadeddata', handleLoadedData);\n    videoTag.src = window.URL.createObjectURL(videoBlob);\n  });\n};\n\nvar _default = getVideoInfo;\nexports.default = _default;"]},"metadata":{},"sourceType":"module"}